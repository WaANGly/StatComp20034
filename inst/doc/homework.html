<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />



<title>homework</title>

<script>// Hide empty <a> tag within highlighted CodeBlock for screen reader accessibility (see https://github.com/jgm/pandoc/issues/6352#issuecomment-626106786) -->
// v0.0.1
// Written by JooYoung Seo (jooyoung@psu.edu) and Atsushi Yasumoto on June 1st, 2020.

document.addEventListener('DOMContentLoaded', function() {
  const codeList = document.getElementsByClassName("sourceCode");
  for (var i = 0; i < codeList.length; i++) {
    var linkList = codeList[i].getElementsByTagName('a');
    for (var j = 0; j < linkList.length; j++) {
      if (linkList[j].innerHTML === "") {
        linkList[j].setAttribute('aria-hidden', 'true');
      }
    }
  }
});
</script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">homework</h1>



<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a><span class="kw">library</span>(StatComp20034)</span>
<span id="cb1-2"><a href="#cb1-2"></a><span class="kw">library</span>(MASS)</span>
<span id="cb1-3"><a href="#cb1-3"></a><span class="kw">library</span>(Ball)</span>
<span id="cb1-4"><a href="#cb1-4"></a><span class="kw">library</span>(energy)</span>
<span id="cb1-5"><a href="#cb1-5"></a><span class="kw">library</span>(DAAG)</span>
<span id="cb1-6"><a href="#cb1-6"></a><span class="co">#&gt; Loading required package: lattice</span></span>
<span id="cb1-7"><a href="#cb1-7"></a><span class="co">#&gt; </span></span>
<span id="cb1-8"><a href="#cb1-8"></a><span class="co">#&gt; Attaching package: &#39;DAAG&#39;</span></span>
<span id="cb1-9"><a href="#cb1-9"></a><span class="co">#&gt; The following object is masked from &#39;package:MASS&#39;:</span></span>
<span id="cb1-10"><a href="#cb1-10"></a><span class="co">#&gt; </span></span>
<span id="cb1-11"><a href="#cb1-11"></a><span class="co">#&gt;     hills</span></span>
<span id="cb1-12"><a href="#cb1-12"></a><span class="kw">library</span>(RANN)</span>
<span id="cb1-13"><a href="#cb1-13"></a><span class="kw">library</span>(boot)</span>
<span id="cb1-14"><a href="#cb1-14"></a><span class="co">#&gt; </span></span>
<span id="cb1-15"><a href="#cb1-15"></a><span class="co">#&gt; Attaching package: &#39;boot&#39;</span></span>
<span id="cb1-16"><a href="#cb1-16"></a><span class="co">#&gt; The following object is masked from &#39;package:lattice&#39;:</span></span>
<span id="cb1-17"><a href="#cb1-17"></a><span class="co">#&gt; </span></span>
<span id="cb1-18"><a href="#cb1-18"></a><span class="co">#&gt;     melanoma</span></span>
<span id="cb1-19"><a href="#cb1-19"></a><span class="kw">library</span>(bootstrap)</span>
<span id="cb1-20"><a href="#cb1-20"></a><span class="kw">library</span>(inline)</span></code></pre></div>
<div id="hw0" class="section level2">
<h2>HW0</h2>
</div>
<div id="question" class="section level2">
<h2>Question</h2>
<p>Use knitr to produce 3 examples in the book.The 1st example should contain texts and atleast one ﬁgure.The 2nd example should contains texts and at least one table.The 3rd example should contain at least a couple of LaTeX formulas.</p>
</div>
<div id="answer" class="section level2">
<h2>## answer</h2>
</div>
<div id="first-example" class="section level2">
<h2>first example :</h2>
</div>
<div id="section" class="section level2">
<h2><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAUVBMVEUAAAAAADoAAGYAOjoAOpAAZrY6AAA6ADo6AGY6kNtmAABmADpmZmZmtv+QOgCQ2/+2ZgC2/7a2///bkDrb/9vb////tmb/25D//7b//9v///8Ave4kAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAGRklEQVR4nO2dDXPaOBQA3VyTXnJXwpU7Evj/P/TAED6SWivbEpLxbmc601h+MlvxZJkX0WwlSFP6AmpHQYCCAAUBCgIUBCgIUBCgIEBBgIIABQEKAhQEKAhQEKAgQEGAggAFAQoCFAQoCFAQoCBAQYCCAAUBCgIUBCgIUBCgIEBBgIIABQEKAhQEKAhQEKAgQEGAggAFAQoCFAQoCFAQoCBAQYCCAAUBCgIUBCgIUBCgIEBBgIIABQEKAhQEKAhQEKAgQEGAggAFAQoCFAQoCFAQoCCgn6Bl0zxuFk3T/Mx0OfXRS9Dq+387R4/b7fvLc64Lqo0+gjaLnZb1t9ftQdU86CPo/WX3zlo//Np+/D0HEo+gZjLkEHTOQa2q0eGS0uM1t82TN2zBWayYoKZn55kE3Tpcz3579H5jQf3f2ompXVCucD37VVC44+I56P3l/FbquA+a+Sy2WdD94WTWvpneYpvFY8pwBcmVg9awjp+9oBuHy4eCAAUBCgIUBCgImI+ggQvk2Qjquwa7PC9twyLhIvsb0OtcngdNRVCucJH9KSjcoTko2KOzWBYUBCgIUBCQVdDbU+djxXkLqvpTjZ7kGUHrpq1ZcAR18v6yL3tRUIDlt1cFBVk1z6MElStwuCLjLPb29McIQUPXTqnJOc1vFt2fHlK4wavv1NT6PGiugqLDKSimQQV+Kr6TvutZzPogIl990LCBRfNC99Gp1QcNS03N8c+AqNUm6dBpfU9ujgbCo+T3RxUEURUEUScmyBzEJ97JLHbjcPkoKmj4zfKXMz/94PKf427JSwoavtz6cuanH1z+c+SirqCg4Qv2L2d++kHT8fcQCj4PuldBu6U6rLMiw92roP3j+KYZu1/Aveeg0Y7ufxZbdT8MS9pvaYYJWre/8L1ZDN93Il5QqSeLx34HCNo/UD2YGbHvRK9+SxjqnSQvZrF2z4kE/ce3u72hU7+Z7oPaXRdCWWrmglYfU9y6a66bt6CLLU06d3/p0++0clAE7f5BB7ry+D3PYkzKEVSaXDnoOIRG56BUDB6HmWaxjw+fO+8kbyxo3LIvbcMi4aJ6G9RnwedBN2Q6gnKFi+pNQeHuKspBFVbaVzaLWR9EFN0/KOkUkCsHFdw/KO3q7f6SdOL1v4KiwqVsWCTcl8gKCoc2BwVjT2EWu3G4fExHUKEni5MRVPLZdNqGecKV+nRjMs+D5iJocDgFxZxgDgqe4SxWJXULquC3DqsWVCrvfL6GtA3ThSs2c329iJQN04VTUFQbBYUbmYOCrZzFqieToOXDr+3bU9N0FsTeStDoMZhHUOvnx+tVMd6IcMMZn8UyfTb/vJPUfrZatgQvwTyYSdDPjzrFT0WcN64PqlVQO3pWjqBu3l8efl18VebYcMOpNAdtD78PtKOzxmPms9jIcBXcH56oUVANK4wTFQqqYo16QkGAgoAKBZmDMJyzWEUjhCgmaDIUEhSI2dFTn8b5QnSjIEBBgIIABQEKAhQEKAhQEDCZtUEpFAQoCFAQoCBAQYCCAAUBCgIUBCgIUBCgICCloHYj09P2eOtAMeyBtz9PdXzBxlcH04WNI6GgzWJ3MauP4qp9EVpnIVrLvl5tG9H46mC6sJEkFHT4+tXV4fIOxZ7LwHZD6/M2VsHGVwfThY0leQ46/o9d2fptu+b5VCobbHx1MF3YWJILWh5fyb7eHLbuPr+SUOOrg+nCxpJa0McmpoeBFE4Ap0sPNr46mC5sLIkFrS9ztIK+cN4E17fYFcfv41id74ICCfL05R05knR02FhSjqDVxRZ5MVPs6ZWknOZjw8aS9D7ocpPpiJu08+BPeaMYGzaShIJWh9Ktb6+H7ShXeJvfvpKIxseDqcPG4WIVUBCgIEBBgIIABQEKAhQEKAhQEKAgQEGAggAFAQoCFAQoCFAQoCBAQYCCAAUBCgIUBCgIUBCgIEBBgIIABQG1C9rXh7W7EJeidkH7KrGunXVvQu2CtuuHf/4aWQM1iuoFbZfdW+vegvoF0bcnZ6Z6QZvF3+PqeEdSvaDV938XBSex6gXt99EfWSs/jtoFLXdTPH7LfU5qF1QcBQEKAhQEKAhQEKAgQEGAggAFAQoCFAQoCFAQoCBAQYCCAAUBCgIUBCgIUBCgIEBBwP/5VVDSZ3U4hQAAAABJRU5ErkJggg==" /><!-- --></h2>
</div>
<div id="second-example" class="section level2">
<h2>second example:</h2>
<table>
<thead>
<tr class="header">
<th>国家</th>
<th>2015</th>
<th>2016</th>
<th>2017</th>
<th>2018</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>中国</td>
<td>8033</td>
<td>8079</td>
<td>8759</td>
<td>9771</td>
</tr>
<tr class="even">
<td>美国</td>
<td>56803</td>
<td>57904</td>
<td>59928</td>
<td>62641</td>
</tr>
<tr class="odd">
<td>日本</td>
<td>35855</td>
<td>37372</td>
<td>40544</td>
<td>41614</td>
</tr>
<tr class="even">
<td>韩国</td>
<td>27105</td>
<td>27608</td>
<td>29743</td>
<td>31363</td>
</tr>
</tbody>
</table>
<hr />
</div>
<div id="third-example" class="section level2">
<h2>third example:</h2>
<p><span class="math display">\[f(x)=\frac{1}{\sqrt{2n\pi}}e^{-\frac{(x-\mu)^{2}}{2\sigma^{2}}}\]</span></p>
<p><span class="math display">\[S^{2}=\frac{\sum(X_{i}-\overline{X})^{2}}{n-1}\]</span></p>
</div>
<div id="hw1" class="section level2">
<h2>HW1</h2>
</div>
<div id="question-1" class="section level2">
<h2>Question</h2>
<p>Exercises 3.3,3.9,3.10,and 3.13(pages 94-95,Statistical Computating with R).</p>
<p>3.3 The Pareto(a,b) distribution has cdf <span class="math display">\[F(x)=1-(\frac{b}{x})^{a},x\geq b&gt;0,a&gt;0\]</span> Derive the probability inverse transformation <span class="math inline">\(F^{-1}(U)\)</span> and use the inverse transform method to simulate a random sample from the Pareto(2,2) distribution.Graph the density histogram of the sample with the Pareto(2,2) density superimposed for comparison.</p>
<p>3.9 The rescaled Epanechnikov kernel [85] is a symmetric density function <span class="math display">\[f_{e}(x)=\frac{3}{4}(1-x^2),  |x|\leq1\]</span> Devroye and Gy$ $rfi [71,p.236] give the following algorithm for simulation from this distribution. Generate iid <span class="math inline">\(U_1,U_2,U_3\sim Uniform(-1,1)\)</span>.If <span class="math inline">\(|U_3|\geq|U_2|\)</span> and <span class="math inline">\(|U_3|\geq|U_1|\)</span>,deliver <span class="math inline">\(U_2\)</span>;otherwise deliver <span class="math inline">\(U_3\)</span>. Write a function to generate random variates from <span class="math inline">\(f_{e}\)</span>,and construct the histogram density estimate of a large simulated random sample.</p>
<p>3.10 Prove that the algorithm given in Exercise 3.9 generates variates from the density <span class="math inline">\(\mathcal{f}_{e}\)</span>.</p>
<p>3.13 It can be shown that the mixture in Exercise 3.12 has a Pareto distribution with cdf <span class="math display">\[F(y)=1-(\frac{\beta}{\beta+y})^{r},y\geq 0\]</span> (This is an alternative parameterization of the Pareto cdf given in Exercise 3.3.) Generate 1000 random observations from the mixture with <span class="math inline">\(r=4\)</span> and <span class="math inline">\(\beta=2\)</span>. Compare the empirical and theoretical (Pareto) distributions by graphing the density histogram of the sample and superimposing the Pareto density curve.</p>
</div>
<div id="answer-1" class="section level2">
<h2>Answer</h2>
</div>
<div id="section-1" class="section level2">
<h2>3.3</h2>
<p><span class="math display">\[F^{-1}(U)=b(1-u)^{-\frac{1}{a}}\]</span></p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a>n&lt;-<span class="dv">100</span></span>
<span id="cb2-2"><a href="#cb2-2"></a>u&lt;-<span class="kw">runif</span>(n)</span>
<span id="cb2-3"><a href="#cb2-3"></a>x&lt;-<span class="dv">2</span><span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>u)<span class="op">^</span>{<span class="op">-</span><span class="dv">1</span><span class="op">/</span><span class="dv">2</span>}</span>
<span id="cb2-4"><a href="#cb2-4"></a><span class="kw">hist</span>(x, <span class="dt">prob =</span> <span class="ot">TRUE</span>, <span class="dt">main =</span> <span class="kw">expression</span>(<span class="kw">f</span>(x)<span class="op">==</span><span class="dv">8</span><span class="op">*</span>x<span class="op">^</span>{<span class="op">-</span><span class="dv">3</span>}))</span>
<span id="cb2-5"><a href="#cb2-5"></a>y&lt;-<span class="kw">seq</span>(<span class="dv">2</span>,<span class="dv">10000</span>,.<span class="dv">01</span>)</span>
<span id="cb2-6"><a href="#cb2-6"></a><span class="kw">lines</span>(y,<span class="dv">8</span><span class="op">*</span>y<span class="op">^</span>{<span class="op">-</span><span class="dv">3</span>})</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="section-2" class="section level2">
<h2>3.9</h2>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a>n&lt;-<span class="dv">10000</span></span>
<span id="cb3-2"><a href="#cb3-2"></a>u1&lt;-<span class="kw">runif</span>(n,<span class="op">-</span><span class="dv">1</span>,<span class="dv">1</span>)</span>
<span id="cb3-3"><a href="#cb3-3"></a>u2&lt;-<span class="kw">runif</span>(n,<span class="op">-</span><span class="dv">1</span>,<span class="dv">1</span>)</span>
<span id="cb3-4"><a href="#cb3-4"></a>u3&lt;-<span class="kw">runif</span>(n,<span class="op">-</span><span class="dv">1</span>,<span class="dv">1</span>)</span>
<span id="cb3-5"><a href="#cb3-5"></a>data&lt;-<span class="kw">data.frame</span>(u1,u2,u3)</span>
<span id="cb3-6"><a href="#cb3-6"></a>random&lt;-<span class="cf">function</span>(data,c1,c2,c3){</span>
<span id="cb3-7"><a href="#cb3-7"></a>  d&lt;-<span class="kw">ifelse</span>(<span class="kw">abs</span>(data[c3])<span class="op">&gt;=</span><span class="kw">max</span>(<span class="kw">abs</span>(data[c2]),<span class="kw">abs</span>(data[c3])<span class="op">&gt;=</span><span class="kw">abs</span>(data[c1])),data[c2],data[c3])</span>
<span id="cb3-8"><a href="#cb3-8"></a><span class="kw">return</span>(d)}</span>
<span id="cb3-9"><a href="#cb3-9"></a>u&lt;-<span class="kw">apply</span>(data,<span class="dv">1</span>,random)</span>
<span id="cb3-10"><a href="#cb3-10"></a><span class="kw">hist</span>(u,<span class="dt">prob=</span><span class="ot">TRUE</span>,<span class="dt">main=</span><span class="ot">NULL</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="section-3" class="section level2">
<h2>3.10</h2>
<p><span class="math display">\[f(u_i)=\left\{
\begin{aligned}
\frac{1}{2} &amp;&amp;-1&lt;u_i&lt;1\\
0&amp;&amp;Otherwise\\
\end{aligned}
\right.
\]</span></p>
<p>令 <span class="math display">\[X=\left\{
\begin{aligned}
U_2 &amp;   &amp;  if&amp;&amp;|U_3|\geq|U_2|and|U_3|\geq|U_1| \\
U_3 &amp;   &amp;  Otherwise\\
\end{aligned}
\right.
\]</span></p>
<p><span class="math display">\[A=\{|U_3|\geq|U_2|and|U_3|\geq|U_1|\}\]</span></p>
<p><span class="math display">\[P(X\leq x)=P(A)P(X\leq x|A)+P(A^c)P(X\leq x|A^c)=P(U_2\leq x,A)+P(U_3\leq x,A^c)\]</span></p>
<p>又<span class="math display">\[P(U_2\leq x,A)=\frac{1}{8}\int_{-1}^{x}du_2(\int_{-1}^{-|u_2|}+\int_{|u_2|}^{1})du_3\int_{-|u_3|}^{|u_3|}du_1=-\frac{1}{12}x^3+\frac{1}{4}x+\frac{1}{6}\]</span></p>
<p><span class="math display">\[P(U_3\leq x,A^c)=P(U_3\leq x)-P(U_3\leq x,A)=\frac{1}{2}\int_{-1}^{x}du_3-\frac{1}{8}\int_{-1}^{x}du_3\int_{-|u_3|}^{|u_3|}du_2\int_{-|u_3|}^{|u_3|}du_1=\frac{x+1}{2}-\frac{1}{6}(x^3+1)=-\frac{1}{6}x^3+\frac{1}{2}x+\frac{1}{3}\]</span></p>
<p><span class="math display">\[P(X\leq x)=-\frac{1}{4}x^3+\frac{3}{4}x+\frac{1}{2}\]</span></p>
<p><span class="math display">\[f(x)=\frac{3}{4}(1-x^2),|x|\leq1\]</span></p>
</div>
<div id="section-4" class="section level2">
<h2>3.13</h2>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1"></a>u&lt;-<span class="kw">runif</span>(<span class="dv">1000</span>)</span>
<span id="cb4-2"><a href="#cb4-2"></a>y&lt;-<span class="dv">2</span><span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>u)<span class="op">^</span>{<span class="op">-</span><span class="dv">1</span><span class="op">/</span><span class="dv">4</span>}<span class="op">-</span><span class="dv">1</span></span>
<span id="cb4-3"><a href="#cb4-3"></a><span class="kw">hist</span>(y,<span class="dt">prob=</span><span class="ot">TRUE</span>,<span class="dt">main=</span><span class="kw">expression</span>(<span class="kw">f</span>(x)<span class="op">==</span><span class="dv">64</span><span class="op">*</span>(<span class="dv">2</span><span class="op">+</span>x)<span class="op">^</span>{<span class="op">-</span><span class="dv">5</span>}))</span>
<span id="cb4-4"><a href="#cb4-4"></a>y=<span class="kw">seq</span>(<span class="dv">0</span>,<span class="dv">10000</span>,<span class="fl">0.1</span>)</span>
<span id="cb4-5"><a href="#cb4-5"></a><span class="kw">lines</span>(y,<span class="dv">64</span><span class="op">*</span>(<span class="dv">2</span><span class="op">+</span>y)<span class="op">^</span>{<span class="op">-</span><span class="dv">5</span>})</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="hw2" class="section level2">
<h2>HW2</h2>
</div>
<div id="question-2" class="section level2">
<h2>Question</h2>
<p>Exercises 5.1, 5.7, and 5.11 (pages 149-151, Statistical Computating with R).</p>
<p>5.1 Compute a Monte Carlo estimate of <span class="math display">\[\int_0^{\frac{\pi}{3}}\sin{t}dt\]</span> and compare your estimate with the exact value of the integral.</p>
<p>5.7 Refer to Exercise 5.6. Use a Monte Carlo simulation to estimate <span class="math inline">\(\theta\)</span> by the antithetic variate approach and by the simple Monte Carlo method. Compute an empirical estimate of the percent reduction in variance using the antithetic variate. Compare the result with the theoretical value from Exercise 5.6.</p>
<p>5.11 If <span class="math inline">\(\hat{\theta}_1\)</span> and <span class="math inline">\(\hat{\theta}_2\)</span> are unbiased estimators of <span class="math inline">\(\theta\)</span>, and <span class="math inline">\(\hat{\theta}_1\)</span> and <span class="math inline">\(\hat{\theta}_2\)</span> are antithetic, we derived that <span class="math inline">\(c^*=1/2\)</span> is the optimal constant that minimizes the variance of <span class="math inline">\(\hat{\theta}_c=c\hat{\theta}_1+(1-c)\hat{\theta}_2\)</span>. Derive <span class="math inline">\(c^*\)</span> for the general case. That is, if <span class="math inline">\(\hat{\theta}_1\)</span> and <span class="math inline">\(\hat{\theta}_2\)</span> are any two unbiased estimators of <span class="math inline">\(\theta\)</span>, find the value <span class="math inline">\(c^*\)</span> that minimizes the variance of the estimator <span class="math inline">\(\hat{\theta}_c=c\hat{\theta}_1+(1-c)\hat{\theta}_2\)</span> in equation (5.11). (<span class="math inline">\(c^*\)</span> will be a function of the variances and the covariance of the estimators.)</p>
</div>
<div id="answer-2" class="section level2">
<h2>Answer</h2>
</div>
<div id="section-5" class="section level2">
<h2>5.1</h2>
<p>Let <span class="math display">\[\int_0^{\frac{\pi}{3}}\sin{t}dt=\int_0^{\frac{\pi}{3}}\frac{3}{\pi}*\frac{\pi}{3}\sin{t}dt=\int_0^{\frac{\pi}{3}}\frac{3}{\pi}g(t)dt=E[g(t)]\]</span> where <span class="math inline">\(t\sim U(0,\frac{\pi}{3}),g(t)=\frac{\pi}{3}\sin{t}\)</span></p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a><span class="kw">set.seed</span>(<span class="dv">333</span>)</span>
<span id="cb5-2"><a href="#cb5-2"></a>t&lt;-<span class="kw">runif</span>(<span class="fl">1e6</span>,<span class="dv">0</span>,pi<span class="op">/</span><span class="dv">3</span>)</span>
<span id="cb5-3"><a href="#cb5-3"></a>theta.hat&lt;-<span class="kw">mean</span>(<span class="kw">sin</span>(t))<span class="op">*</span>pi<span class="op">/</span><span class="dv">3</span></span>
<span id="cb5-4"><a href="#cb5-4"></a>f&lt;-<span class="kw">c</span>(theta.hat,<span class="kw">cos</span>(<span class="dv">0</span>)<span class="op">-</span><span class="kw">cos</span>(pi<span class="op">/</span><span class="dv">3</span>))</span>
<span id="cb5-5"><a href="#cb5-5"></a>f</span>
<span id="cb5-6"><a href="#cb5-6"></a><span class="co">#&gt; [1] 0.4994569 0.5000000</span></span></code></pre></div>
</div>
<div id="section-6" class="section level2">
<h2>5.7</h2>
<p><span class="math display">\[E(e^{1-U})=\int_0^1e^{1-u}du=\int_0^1e^udu=e-1=E(e^U)\]</span> <span class="math display">\[E(e^{2-2U})=\int_0^1e^{2-2u}du=\int_0^1e^{2u}du=\frac{e^2-1}{2}=E(e^{2U})\]</span> so <span class="math display">\[Var(e^U)=Var(e^{1-U})\]</span></p>
<p><span class="math display">\[Cov(e^U,e^{1-U})=E(e^Ue^{1-U})-E(e^U)E(e^{1-U})=e-(e-1)^2\]</span> <span class="math display">\[Var(e^U+e^{1-U})=2Var(e^U)+2Cov(e^U,e^{1-U})=-3e^2+10e-5=0.01564999\]</span></p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1"></a><span class="kw">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb6-2"><a href="#cb6-2"></a>n&lt;-<span class="fl">1e5</span></span>
<span id="cb6-3"><a href="#cb6-3"></a>u&lt;-<span class="kw">runif</span>(n)</span>
<span id="cb6-4"><a href="#cb6-4"></a>U&lt;-<span class="kw">exp</span>(u)</span>
<span id="cb6-5"><a href="#cb6-5"></a>x&lt;-<span class="st"> </span>(<span class="kw">exp</span>(u)<span class="op">+</span><span class="kw">exp</span>(<span class="dv">1</span><span class="op">-</span>u))<span class="op">/</span><span class="dv">2</span></span>
<span id="cb6-6"><a href="#cb6-6"></a>theta1&lt;-<span class="kw">mean</span>(U)<span class="co"># the simple Monte Carlo method</span></span>
<span id="cb6-7"><a href="#cb6-7"></a>theta2&lt;-<span class="kw">mean</span>(x)<span class="co">#the antithetic variate approach</span></span>
<span id="cb6-8"><a href="#cb6-8"></a>theta&lt;-<span class="kw">exp</span>(<span class="dv">1</span>)<span class="op">-</span><span class="dv">1</span><span class="co">#the real value</span></span>
<span id="cb6-9"><a href="#cb6-9"></a><span class="kw">cat</span>(<span class="st">&quot;the simple MC:&quot;</span>,theta1,<span class="st">&quot;</span><span class="ch">\n</span><span class="st">the antithetic variate approach:&quot;</span>,theta2,<span class="st">&quot;</span><span class="ch">\n</span><span class="st">the real value:&quot;</span>,theta,<span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span>)</span>
<span id="cb6-10"><a href="#cb6-10"></a><span class="co">#&gt; the simple MC: 1.719168 </span></span>
<span id="cb6-11"><a href="#cb6-11"></a><span class="co">#&gt; the antithetic variate approach: 1.718349 </span></span>
<span id="cb6-12"><a href="#cb6-12"></a><span class="co">#&gt; the real value: 1.718282</span></span>
<span id="cb6-13"><a href="#cb6-13"></a></span>
<span id="cb6-14"><a href="#cb6-14"></a>v1&lt;-<span class="kw">var</span>(U)</span>
<span id="cb6-15"><a href="#cb6-15"></a>v2&lt;-<span class="kw">var</span>(x)</span>
<span id="cb6-16"><a href="#cb6-16"></a>reduction&lt;-(v1<span class="op">-</span>v2)<span class="op">/</span>v1<span class="co"># the percent reduction in variance </span></span>
<span id="cb6-17"><a href="#cb6-17"></a><span class="kw">cat</span>(<span class="st">&quot;empirical percent reduction in variate:&quot;</span>,reduction,<span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span>)</span>
<span id="cb6-18"><a href="#cb6-18"></a><span class="co">#&gt; empirical percent reduction in variate: 0.9838316</span></span>
<span id="cb6-19"><a href="#cb6-19"></a></span>
<span id="cb6-20"><a href="#cb6-20"></a>tv1&lt;-<span class="op">-</span><span class="kw">exp</span>(<span class="dv">2</span>)<span class="op">+</span><span class="dv">4</span><span class="op">*</span><span class="kw">exp</span>(<span class="dv">1</span>)<span class="op">-</span><span class="dv">3</span><span class="co">#theoretical variance using simple MC</span></span>
<span id="cb6-21"><a href="#cb6-21"></a>tv2&lt;-<span class="op">-</span><span class="dv">3</span><span class="op">*</span><span class="kw">exp</span>(<span class="dv">2</span>)<span class="op">+</span><span class="dv">10</span><span class="op">*</span><span class="kw">exp</span>(<span class="dv">1</span>)<span class="op">-</span><span class="dv">5</span><span class="co">#theoretical variance using the antithetic variate approach</span></span>
<span id="cb6-22"><a href="#cb6-22"></a>d&lt;-(tv1<span class="dv">-2</span><span class="op">*</span>tv2)<span class="op">/</span>tv1</span>
<span id="cb6-23"><a href="#cb6-23"></a><span class="kw">cat</span>(<span class="st">&quot;theoretical percent reduction in variance:&quot;</span>,d,<span class="st">&quot;&quot;</span>)</span>
<span id="cb6-24"><a href="#cb6-24"></a><span class="co">#&gt; theoretical percent reduction in variance: 0.9353401</span></span></code></pre></div>
</div>
<div id="section-7" class="section level2">
<h2>5.11</h2>
<p>Let <span class="math inline">\(\hat{\theta}_c=c\hat{\theta}_1+(1-c)\hat{\theta}_2\)</span>,then <span class="math display">\[Var(\hat{\theta}_c)=c^2Var(\hat{\theta}_1)+(1-c)^2Var(\hat{\theta}_2)+2c(1-c)Cov(\hat{\theta}_1,\hat{\theta}_2)=Var(\hat{\theta}_2)+c^2Var(\hat{\theta}_1-\hat{\theta}_2)+2cCov(\hat{\theta}_2,\hat{\theta}_1-\hat{\theta}_2)\]</span> <span class="math inline">\(Var(\hat{\theta}_c)\)</span>is minimized when <span class="math display">\[c^*=-\frac{Cov(\hat{\theta}_2,\hat{\theta}_1-\hat{\theta}_2)}{Var({\hat{\theta}_1-\hat{\theta}_2})}\]</span></p>
</div>
<div id="hw3" class="section level2">
<h2>HW3</h2>
</div>
<div id="question-3" class="section level2">
<h2>Question</h2>
<p>Exercises 5.1, 5.7, and 5.11 (pages 149-151, Statistical Computating with R).</p>
<p>5.1 Compute a Monte Carlo estimate of <span class="math display">\[\int_0^{\frac{\pi}{3}}\sin{t}dt\]</span> and compare your estimate with the exact value of the integral.</p>
<p>5.7 Refer to Exercise 5.6. Use a Monte Carlo simulation to estimate <span class="math inline">\(\theta\)</span> by the antithetic variate approach and by the simple Monte Carlo method. Compute an empirical estimate of the percent reduction in variance using the antithetic variate. Compare the result with the theoretical value from Exercise 5.6.</p>
<p>5.11 If <span class="math inline">\(\hat{\theta}_1\)</span> and <span class="math inline">\(\hat{\theta}_2\)</span> are unbiased estimators of <span class="math inline">\(\theta\)</span>, and <span class="math inline">\(\hat{\theta}_1\)</span> and <span class="math inline">\(\hat{\theta}_2\)</span> are antithetic, we derived that <span class="math inline">\(c^*=1/2\)</span> is the optimal constant that minimizes the variance of <span class="math inline">\(\hat{\theta}_c=c\hat{\theta}_1+(1-c)\hat{\theta}_2\)</span>. Derive <span class="math inline">\(c^*\)</span> for the general case. That is, if <span class="math inline">\(\hat{\theta}_1\)</span> and <span class="math inline">\(\hat{\theta}_2\)</span> are any two unbiased estimators of <span class="math inline">\(\theta\)</span>, find the value <span class="math inline">\(c^*\)</span> that minimizes the variance of the estimator <span class="math inline">\(\hat{\theta}_c=c\hat{\theta}_1+(1-c)\hat{\theta}_2\)</span> in equation (5.11). (<span class="math inline">\(c^*\)</span> will be a function of the variances and the covariance of the estimators.)</p>
</div>
<div id="answer-3" class="section level2">
<h2>Answer</h2>
</div>
<div id="section-8" class="section level2">
<h2>5.1</h2>
<p>Let <span class="math display">\[\int_0^{\frac{\pi}{3}}\sin{t}dt=\int_0^{\frac{\pi}{3}}\frac{3}{\pi}*\frac{\pi}{3}\sin{t}dt=\int_0^{\frac{\pi}{3}}\frac{3}{\pi}g(t)dt=E[g(t)]\]</span> where <span class="math inline">\(t\sim U(0,\frac{\pi}{3}),g(t)=\frac{\pi}{3}\sin{t}\)</span></p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a><span class="kw">set.seed</span>(<span class="dv">333</span>)</span>
<span id="cb7-2"><a href="#cb7-2"></a>t&lt;-<span class="kw">runif</span>(<span class="fl">1e6</span>,<span class="dv">0</span>,pi<span class="op">/</span><span class="dv">3</span>)</span>
<span id="cb7-3"><a href="#cb7-3"></a>theta.hat&lt;-<span class="kw">mean</span>(<span class="kw">sin</span>(t))<span class="op">*</span>pi<span class="op">/</span><span class="dv">3</span></span>
<span id="cb7-4"><a href="#cb7-4"></a>f&lt;-<span class="kw">c</span>(theta.hat,<span class="kw">cos</span>(<span class="dv">0</span>)<span class="op">-</span><span class="kw">cos</span>(pi<span class="op">/</span><span class="dv">3</span>))</span>
<span id="cb7-5"><a href="#cb7-5"></a>f</span>
<span id="cb7-6"><a href="#cb7-6"></a><span class="co">#&gt; [1] 0.4994569 0.5000000</span></span></code></pre></div>
</div>
<div id="section-9" class="section level2">
<h2>5.7</h2>
<p><span class="math display">\[E(e^{1-U})=\int_0^1e^{1-u}du=\int_0^1e^udu=e-1=E(e^U)\]</span> <span class="math display">\[E(e^{2-2U})=\int_0^1e^{2-2u}du=\int_0^1e^{2u}du=\frac{e^2-1}{2}=E(e^{2U})\]</span> so <span class="math display">\[Var(e^U)=Var(e^{1-U})\]</span></p>
<p><span class="math display">\[Cov(e^U,e^{1-U})=E(e^Ue^{1-U})-E(e^U)E(e^{1-U})=e-(e-1)^2\]</span> <span class="math display">\[Var(e^U+e^{1-U})=2Var(e^U)+2Cov(e^U,e^{1-U})=-3e^2+10e-5=0.01564999\]</span></p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1"></a><span class="kw">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb8-2"><a href="#cb8-2"></a>n&lt;-<span class="fl">1e5</span></span>
<span id="cb8-3"><a href="#cb8-3"></a>u&lt;-<span class="kw">runif</span>(n)</span>
<span id="cb8-4"><a href="#cb8-4"></a>U&lt;-<span class="kw">exp</span>(u)</span>
<span id="cb8-5"><a href="#cb8-5"></a>x&lt;-<span class="st"> </span>(<span class="kw">exp</span>(u)<span class="op">+</span><span class="kw">exp</span>(<span class="dv">1</span><span class="op">-</span>u))<span class="op">/</span><span class="dv">2</span></span>
<span id="cb8-6"><a href="#cb8-6"></a>theta1&lt;-<span class="kw">mean</span>(U)<span class="co"># the simple Monte Carlo method</span></span>
<span id="cb8-7"><a href="#cb8-7"></a>theta2&lt;-<span class="kw">mean</span>(x)<span class="co">#the antithetic variate approach</span></span>
<span id="cb8-8"><a href="#cb8-8"></a>theta&lt;-<span class="kw">exp</span>(<span class="dv">1</span>)<span class="op">-</span><span class="dv">1</span><span class="co">#the real value</span></span>
<span id="cb8-9"><a href="#cb8-9"></a><span class="kw">cat</span>(<span class="st">&quot;the simple MC:&quot;</span>,theta1,<span class="st">&quot;</span><span class="ch">\n</span><span class="st">the antithetic variate approach:&quot;</span>,theta2,<span class="st">&quot;</span><span class="ch">\n</span><span class="st">the real value:&quot;</span>,theta,<span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span>)</span>
<span id="cb8-10"><a href="#cb8-10"></a><span class="co">#&gt; the simple MC: 1.719168 </span></span>
<span id="cb8-11"><a href="#cb8-11"></a><span class="co">#&gt; the antithetic variate approach: 1.718349 </span></span>
<span id="cb8-12"><a href="#cb8-12"></a><span class="co">#&gt; the real value: 1.718282</span></span>
<span id="cb8-13"><a href="#cb8-13"></a></span>
<span id="cb8-14"><a href="#cb8-14"></a>v1&lt;-<span class="kw">var</span>(U)</span>
<span id="cb8-15"><a href="#cb8-15"></a>v2&lt;-<span class="kw">var</span>(x)</span>
<span id="cb8-16"><a href="#cb8-16"></a>reduction&lt;-(v1<span class="op">-</span>v2)<span class="op">/</span>v1<span class="co"># the percent reduction in variance </span></span>
<span id="cb8-17"><a href="#cb8-17"></a><span class="kw">cat</span>(<span class="st">&quot;empirical percent reduction in variate:&quot;</span>,reduction,<span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span>)</span>
<span id="cb8-18"><a href="#cb8-18"></a><span class="co">#&gt; empirical percent reduction in variate: 0.9838316</span></span>
<span id="cb8-19"><a href="#cb8-19"></a></span>
<span id="cb8-20"><a href="#cb8-20"></a>tv1&lt;-<span class="op">-</span><span class="kw">exp</span>(<span class="dv">2</span>)<span class="op">+</span><span class="dv">4</span><span class="op">*</span><span class="kw">exp</span>(<span class="dv">1</span>)<span class="op">-</span><span class="dv">3</span><span class="co">#theoretical variance using simple MC</span></span>
<span id="cb8-21"><a href="#cb8-21"></a>tv2&lt;-<span class="op">-</span><span class="dv">3</span><span class="op">*</span><span class="kw">exp</span>(<span class="dv">2</span>)<span class="op">+</span><span class="dv">10</span><span class="op">*</span><span class="kw">exp</span>(<span class="dv">1</span>)<span class="op">-</span><span class="dv">5</span><span class="co">#theoretical variance using the antithetic variate approach</span></span>
<span id="cb8-22"><a href="#cb8-22"></a>d&lt;-(tv1<span class="dv">-2</span><span class="op">*</span>tv2)<span class="op">/</span>tv1</span>
<span id="cb8-23"><a href="#cb8-23"></a><span class="kw">cat</span>(<span class="st">&quot;theoretical percent reduction in variance:&quot;</span>,d,<span class="st">&quot;&quot;</span>)</span>
<span id="cb8-24"><a href="#cb8-24"></a><span class="co">#&gt; theoretical percent reduction in variance: 0.9353401</span></span></code></pre></div>
</div>
<div id="section-10" class="section level2">
<h2>5.11</h2>
<p>Let <span class="math inline">\(\hat{\theta}_c=c\hat{\theta}_1+(1-c)\hat{\theta}_2\)</span>,then <span class="math display">\[Var(\hat{\theta}_c)=c^2Var(\hat{\theta}_1)+(1-c)^2Var(\hat{\theta}_2)+2c(1-c)Cov(\hat{\theta}_1,\hat{\theta}_2)=Var(\hat{\theta}_2)+c^2Var(\hat{\theta}_1-\hat{\theta}_2)+2cCov(\hat{\theta}_2,\hat{\theta}_1-\hat{\theta}_2)\]</span> <span class="math inline">\(Var(\hat{\theta}_c)\)</span>is minimized when <span class="math display">\[c^*=-\frac{Cov(\hat{\theta}_2,\hat{\theta}_1-\hat{\theta}_2)}{Var({\hat{\theta}_1-\hat{\theta}_2})}\]</span></p>
</div>
<div id="hw4" class="section level2">
<h2>HW4</h2>
</div>
<div id="question-4" class="section level2">
<h2>Question</h2>
<p>Exercises 6.7, 6.8, and 6.C (pages 180-182, Statistical Computating with R)</p>
<p>6.7 Estimate the power of the skewness test of normality against symmetric <span class="math inline">\(Beta(\alpha,\alpha)\)</span> distributions and comment on the results. Are the results different for heavy-tailed symmetric alternatives such as <span class="math inline">\(t(v)\)</span>?</p>
<p>6.8 Refer to Example 6.16. Repeat the simulation, but also compute the <span class="math inline">\(F\)</span> test of equal variance, at significance level <span class="math inline">\(\hat{\alpha}\doteq0.055\)</span>. Compare the power of the Count Five test and <span class="math inline">\(F\)</span> test for small, medium, and large sample sizes. (Recall that the <span class="math inline">\(F\)</span> test is not applicable for non-normal distributions.)</p>
<p>6.C Repeat Examples 6.8 and 6.10 for Mardia’s multivariate skewness test. Mardia [187] proposed tests of multivariate normality based on multivariate generalizations of skewness and kurtosis. If <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> are iid, the multivariate population skewness <span class="math inline">\(\beta_{1,d}\)</span> is defined by Mardia as <span class="math display">\[\beta_{1,d}=E[(X-\mu)^T\Sigma^{-1}(Y-\mu)]^3\]</span> Under normality,<span class="math inline">\(\beta_{1,d}=0\)</span>. The multivariate skewness statistic is <span class="math display">\[b_{1,d}=\frac{1}{n^2}\sum_{i,j=1}^{n}((X_i-\overline{X})^T\hat{\Sigma}^{-1}(X_j-\overline{X}))^3\]</span> where <span class="math inline">\(\Sigma\)</span> is the maximum likelihood estimator of covariance. Large values of <span class="math inline">\(b_{1,d}\)</span> are significant. The asymptotic distribution of <span class="math inline">\(nb_{1,d}/6\)</span> is chisquared with <span class="math inline">\(d(d+1)(d+2)/6\)</span> degrees of freedom.</p>
</div>
<div id="answer-4" class="section level2">
<h2>Answer</h2>
<div id="section-11" class="section level4">
<h4>6.7</h4>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1"></a>sk &lt;-<span class="st"> </span><span class="cf">function</span>(x) {</span>
<span id="cb9-2"><a href="#cb9-2"></a>  xbar &lt;-<span class="st"> </span><span class="kw">mean</span>(x)</span>
<span id="cb9-3"><a href="#cb9-3"></a>  m3 &lt;-<span class="st"> </span><span class="kw">mean</span>((x <span class="op">-</span><span class="st"> </span>xbar)<span class="op">^</span><span class="dv">3</span>)</span>
<span id="cb9-4"><a href="#cb9-4"></a>  m2 &lt;-<span class="st"> </span><span class="kw">mean</span>((x <span class="op">-</span><span class="st"> </span>xbar)<span class="op">^</span><span class="dv">2</span>)</span>
<span id="cb9-5"><a href="#cb9-5"></a>  <span class="kw">return</span>( m3 <span class="op">/</span><span class="st"> </span>m2<span class="op">^</span><span class="fl">1.5</span> )</span>
<span id="cb9-6"><a href="#cb9-6"></a> }<span class="co">#computes the sample skewness coeff.</span></span>
<span id="cb9-7"><a href="#cb9-7"></a></span>
<span id="cb9-8"><a href="#cb9-8"></a>n&lt;-<span class="dv">30</span></span>
<span id="cb9-9"><a href="#cb9-9"></a>m&lt;-<span class="dv">1000</span></span>
<span id="cb9-10"><a href="#cb9-10"></a>alpha&lt;-<span class="kw">seq</span>(<span class="dv">0</span>,<span class="dv">100</span>,<span class="dv">1</span>)</span>
<span id="cb9-11"><a href="#cb9-11"></a>p&lt;-<span class="st"> </span><span class="kw">numeric</span>(<span class="kw">length</span>(alpha))</span>
<span id="cb9-12"><a href="#cb9-12"></a>cv&lt;-<span class="kw">qnorm</span>(<span class="fl">0.975</span>,<span class="dv">0</span>,<span class="kw">sqrt</span>(<span class="dv">6</span><span class="op">*</span>(n<span class="dv">-2</span>)<span class="op">/</span>((n<span class="op">+</span><span class="dv">1</span>)<span class="op">*</span>(n<span class="op">+</span><span class="dv">3</span>))))</span>
<span id="cb9-13"><a href="#cb9-13"></a></span>
<span id="cb9-14"><a href="#cb9-14"></a><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(alpha)) { <span class="co">#for each alpha</span></span>
<span id="cb9-15"><a href="#cb9-15"></a>  a&lt;-alpha[j]</span>
<span id="cb9-16"><a href="#cb9-16"></a>  sktests &lt;-<span class="st"> </span><span class="kw">numeric</span>(m)</span>
<span id="cb9-17"><a href="#cb9-17"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m) { <span class="co">#for each replicate</span></span>
<span id="cb9-18"><a href="#cb9-18"></a>  x &lt;-<span class="st"> </span><span class="kw">rbeta</span>(n, <span class="dt">shape1=</span>a, <span class="dt">shape2=</span>a)</span>
<span id="cb9-19"><a href="#cb9-19"></a>  sktests[i] &lt;-<span class="st"> </span><span class="kw">as.integer</span>(<span class="kw">abs</span>(<span class="kw">sk</span>(x)) <span class="op">&gt;=</span><span class="st"> </span>cv)</span>
<span id="cb9-20"><a href="#cb9-20"></a>  }</span>
<span id="cb9-21"><a href="#cb9-21"></a>p[j] &lt;-<span class="st"> </span><span class="kw">mean</span>(sktests)</span>
<span id="cb9-22"><a href="#cb9-22"></a>}</span>
<span id="cb9-23"><a href="#cb9-23"></a><span class="kw">plot</span>(alpha, p, <span class="dt">type =</span> <span class="st">&quot;l&quot;</span>,</span>
<span id="cb9-24"><a href="#cb9-24"></a><span class="dt">xlab =</span> <span class="st">&quot;alpha&quot;</span>, <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="fl">0.15</span>))</span>
<span id="cb9-25"><a href="#cb9-25"></a><span class="kw">abline</span>(<span class="dt">h=</span><span class="fl">0.05</span>,<span class="dt">lty=</span><span class="dv">3</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1"></a>sk &lt;-<span class="st"> </span><span class="cf">function</span>(x) {</span>
<span id="cb10-2"><a href="#cb10-2"></a>  xbar &lt;-<span class="st"> </span><span class="kw">mean</span>(x)</span>
<span id="cb10-3"><a href="#cb10-3"></a>  m3 &lt;-<span class="st"> </span><span class="kw">mean</span>((x <span class="op">-</span><span class="st"> </span>xbar)<span class="op">^</span><span class="dv">3</span>)</span>
<span id="cb10-4"><a href="#cb10-4"></a>  m2 &lt;-<span class="st"> </span><span class="kw">mean</span>((x <span class="op">-</span><span class="st"> </span>xbar)<span class="op">^</span><span class="dv">2</span>)</span>
<span id="cb10-5"><a href="#cb10-5"></a>  <span class="kw">return</span>( m3 <span class="op">/</span><span class="st"> </span>m2<span class="op">^</span><span class="fl">1.5</span> )</span>
<span id="cb10-6"><a href="#cb10-6"></a> }<span class="co">#computes the sample skewness coeff.</span></span>
<span id="cb10-7"><a href="#cb10-7"></a></span>
<span id="cb10-8"><a href="#cb10-8"></a>n&lt;-<span class="dv">30</span></span>
<span id="cb10-9"><a href="#cb10-9"></a>m&lt;-<span class="dv">1000</span></span>
<span id="cb10-10"><a href="#cb10-10"></a>v&lt;-<span class="kw">seq</span>(<span class="dv">1</span>,<span class="dv">100</span>,<span class="dv">1</span>)</span>
<span id="cb10-11"><a href="#cb10-11"></a>p&lt;-<span class="st"> </span><span class="kw">numeric</span>(<span class="kw">length</span>(v))</span>
<span id="cb10-12"><a href="#cb10-12"></a>cv&lt;-<span class="kw">qnorm</span>(<span class="fl">0.975</span>,<span class="dv">0</span>,<span class="kw">sqrt</span>(<span class="dv">6</span><span class="op">*</span>(n<span class="dv">-2</span>)<span class="op">/</span>((n<span class="op">+</span><span class="dv">1</span>)<span class="op">*</span>(n<span class="op">+</span><span class="dv">3</span>))))</span>
<span id="cb10-13"><a href="#cb10-13"></a></span>
<span id="cb10-14"><a href="#cb10-14"></a><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(v)) { <span class="co">#for each v</span></span>
<span id="cb10-15"><a href="#cb10-15"></a>  a&lt;-v[j]</span>
<span id="cb10-16"><a href="#cb10-16"></a>  sktests &lt;-<span class="st"> </span><span class="kw">numeric</span>(m)</span>
<span id="cb10-17"><a href="#cb10-17"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m) { <span class="co">#for each replicate</span></span>
<span id="cb10-18"><a href="#cb10-18"></a>  x &lt;-<span class="st"> </span><span class="kw">rt</span>(n,a)</span>
<span id="cb10-19"><a href="#cb10-19"></a>  sktests[i] &lt;-<span class="st"> </span><span class="kw">as.integer</span>(<span class="kw">abs</span>(<span class="kw">sk</span>(x)) <span class="op">&gt;=</span><span class="st"> </span>cv)</span>
<span id="cb10-20"><a href="#cb10-20"></a>  }</span>
<span id="cb10-21"><a href="#cb10-21"></a>p[j] &lt;-<span class="st"> </span><span class="kw">mean</span>(sktests)</span>
<span id="cb10-22"><a href="#cb10-22"></a>}</span>
<span id="cb10-23"><a href="#cb10-23"></a><span class="kw">plot</span>(v, p, <span class="dt">type =</span> <span class="st">&quot;l&quot;</span>,<span class="dt">xlab =</span> <span class="st">&quot;v&quot;</span>,<span class="dt">ylim=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>))</span>
<span id="cb10-24"><a href="#cb10-24"></a><span class="kw">abline</span>(<span class="dt">h=</span><span class="fl">0.05</span>,<span class="dt">lty=</span><span class="dv">3</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="section-12" class="section level4">
<h4>6.8</h4>
<div id="the-count-five" class="section level5">
<h5>The Count Five</h5>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1"></a>sigma1 &lt;-<span class="st"> </span><span class="dv">1</span></span>
<span id="cb11-2"><a href="#cb11-2"></a>sigma2 &lt;-<span class="st"> </span><span class="fl">1.5</span></span>
<span id="cb11-3"><a href="#cb11-3"></a>count5test &lt;-<span class="st"> </span><span class="cf">function</span>(x, y) {</span>
<span id="cb11-4"><a href="#cb11-4"></a>X &lt;-<span class="st"> </span>x <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(x)</span>
<span id="cb11-5"><a href="#cb11-5"></a>Y &lt;-<span class="st"> </span>y <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(y)</span>
<span id="cb11-6"><a href="#cb11-6"></a>outx &lt;-<span class="st"> </span><span class="kw">sum</span>(X <span class="op">&gt;</span><span class="st"> </span><span class="kw">max</span>(Y)) <span class="op">+</span><span class="st"> </span><span class="kw">sum</span>(X <span class="op">&lt;</span><span class="st"> </span><span class="kw">min</span>(Y))</span>
<span id="cb11-7"><a href="#cb11-7"></a>outy &lt;-<span class="st"> </span><span class="kw">sum</span>(Y <span class="op">&gt;</span><span class="st"> </span><span class="kw">max</span>(X)) <span class="op">+</span><span class="st"> </span><span class="kw">sum</span>(Y <span class="op">&lt;</span><span class="st"> </span><span class="kw">min</span>(X))</span>
<span id="cb11-8"><a href="#cb11-8"></a><span class="co"># return 1 (reject) or 0 (do not reject H0)</span></span>
<span id="cb11-9"><a href="#cb11-9"></a><span class="kw">return</span>(<span class="kw">as.integer</span>(<span class="kw">max</span>(<span class="kw">c</span>(outx, outy)) <span class="op">&gt;</span><span class="st"> </span><span class="dv">5</span>))</span>
<span id="cb11-10"><a href="#cb11-10"></a>}</span>
<span id="cb11-11"><a href="#cb11-11"></a>power &lt;-<span class="st"> </span><span class="kw">mean</span>(<span class="kw">replicate</span>(m, <span class="dt">expr=</span>{</span>
<span id="cb11-12"><a href="#cb11-12"></a>x &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">20</span>, <span class="dv">0</span>, sigma1)</span>
<span id="cb11-13"><a href="#cb11-13"></a>y &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">20</span>, <span class="dv">0</span>, sigma2)</span>
<span id="cb11-14"><a href="#cb11-14"></a><span class="kw">count5test</span>(x, y)</span>
<span id="cb11-15"><a href="#cb11-15"></a>}))</span>
<span id="cb11-16"><a href="#cb11-16"></a></span>
<span id="cb11-17"><a href="#cb11-17"></a><span class="kw">print</span>(power)</span>
<span id="cb11-18"><a href="#cb11-18"></a><span class="co">#&gt; [1] 0.318</span></span></code></pre></div>
</div>
<div id="the-f-test" class="section level5">
<h5>the F test</h5>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1"></a>alpha&lt;-<span class="fl">0.055</span></span>
<span id="cb12-2"><a href="#cb12-2"></a>n1&lt;-<span class="dv">20</span></span>
<span id="cb12-3"><a href="#cb12-3"></a>n2&lt;-<span class="dv">20</span></span>
<span id="cb12-4"><a href="#cb12-4"></a>d1&lt;-<span class="kw">qf</span>(alpha<span class="op">/</span><span class="dv">2</span>,n1<span class="dv">-1</span>,n2<span class="dv">-1</span>)</span>
<span id="cb12-5"><a href="#cb12-5"></a>d2&lt;-<span class="kw">qf</span>(<span class="dv">1</span><span class="op">-</span>alpha<span class="op">/</span><span class="dv">2</span>,n1<span class="dv">-1</span>,n2<span class="dv">-1</span>)</span>
<span id="cb12-6"><a href="#cb12-6"></a>m&lt;-<span class="dv">1000</span></span>
<span id="cb12-7"><a href="#cb12-7"></a>b&lt;-<span class="kw">numeric</span>(m)</span>
<span id="cb12-8"><a href="#cb12-8"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){</span>
<span id="cb12-9"><a href="#cb12-9"></a>  x &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n1, <span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb12-10"><a href="#cb12-10"></a>  y &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n2, <span class="dv">0</span>, <span class="fl">1.5</span>)</span>
<span id="cb12-11"><a href="#cb12-11"></a>  s&lt;-<span class="kw">var</span>(x)<span class="op">/</span><span class="kw">var</span>(y)</span>
<span id="cb12-12"><a href="#cb12-12"></a>  b[i]&lt;-<span class="kw">as.integer</span>((s<span class="op">&gt;</span>d1)<span class="op">&amp;&amp;</span>(s<span class="op">&lt;</span>d2))</span>
<span id="cb12-13"><a href="#cb12-13"></a>}</span>
<span id="cb12-14"><a href="#cb12-14"></a><span class="kw">mean</span>(b)</span>
<span id="cb12-15"><a href="#cb12-15"></a><span class="co">#&gt; [1] 0.556</span></span></code></pre></div>
</div>
<div id="compare-the-power-of-the-count-five-test-and-f-test-for-small-medium-and-large-sample-sizes" class="section level5">
<h5>. Compare the power of the Count Five test and F test for small, medium, and large sample sizes</h5>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1"></a>alpha &lt;-<span class="st"> </span><span class="fl">0.055</span></span>
<span id="cb13-2"><a href="#cb13-2"></a>n &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">20</span>,<span class="dv">200</span>,<span class="dv">2000</span>,<span class="dv">20000</span>)</span>
<span id="cb13-3"><a href="#cb13-3"></a>m &lt;-<span class="st"> </span><span class="dv">1000</span> </span>
<span id="cb13-4"><a href="#cb13-4"></a>cf &lt;-<span class="st"> </span>f &lt;-b1&lt;-b2&lt;-<span class="st">  </span><span class="kw">vector</span>()</span>
<span id="cb13-5"><a href="#cb13-5"></a><span class="co"># estimate power</span></span>
<span id="cb13-6"><a href="#cb13-6"></a><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">4</span>) {</span>
<span id="cb13-7"><a href="#cb13-7"></a>  a&lt;-n[j]</span>
<span id="cb13-8"><a href="#cb13-8"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){</span>
<span id="cb13-9"><a href="#cb13-9"></a>  x &lt;-<span class="st"> </span><span class="kw">rnorm</span>(a, <span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb13-10"><a href="#cb13-10"></a>  y &lt;-<span class="st"> </span><span class="kw">rnorm</span>(a, <span class="dv">0</span>, <span class="fl">1.5</span>)</span>
<span id="cb13-11"><a href="#cb13-11"></a>  outx &lt;-<span class="st"> </span><span class="kw">sum</span>(x <span class="op">&gt;</span><span class="st"> </span><span class="kw">max</span>(y)) <span class="op">+</span><span class="st"> </span><span class="kw">sum</span>(x <span class="op">&lt;</span><span class="st"> </span><span class="kw">min</span>(y))</span>
<span id="cb13-12"><a href="#cb13-12"></a>  outy &lt;-<span class="st"> </span><span class="kw">sum</span>(y <span class="op">&gt;</span><span class="st"> </span><span class="kw">max</span>(x)) <span class="op">+</span><span class="st"> </span><span class="kw">sum</span>(y <span class="op">&lt;</span><span class="st"> </span><span class="kw">min</span>(x))</span>
<span id="cb13-13"><a href="#cb13-13"></a>  b1[i]&lt;-<span class="kw">as.integer</span>(<span class="kw">max</span>(<span class="kw">c</span>(outx, outy)) <span class="op">&gt;</span><span class="st"> </span><span class="dv">5</span>)<span class="co">#the Count Five test</span></span>
<span id="cb13-14"><a href="#cb13-14"></a>  s&lt;-<span class="kw">var</span>(x)<span class="op">/</span><span class="kw">var</span>(y)</span>
<span id="cb13-15"><a href="#cb13-15"></a>  b2[i]&lt;-<span class="kw">as.integer</span>((s<span class="op">&gt;</span>d1)<span class="op">&amp;&amp;</span>(s<span class="op">&lt;</span>d2))<span class="co">#  the F test</span></span>
<span id="cb13-16"><a href="#cb13-16"></a>}</span>
<span id="cb13-17"><a href="#cb13-17"></a>  cf[j]=<span class="kw">mean</span>(b1)</span>
<span id="cb13-18"><a href="#cb13-18"></a>  f[j]=<span class="kw">mean</span>(b2)</span>
<span id="cb13-19"><a href="#cb13-19"></a>  }</span>
<span id="cb13-20"><a href="#cb13-20"></a>d =<span class="st"> </span><span class="kw">data.frame</span>(cf,f,<span class="dt">row.names =</span> <span class="kw">c</span>(<span class="st">&quot;n=20&quot;</span>,<span class="st">&quot;n=200&quot;</span>,<span class="st">&quot;n=2000&quot;</span>,<span class="st">&quot;n=20000&quot;</span>))</span>
<span id="cb13-21"><a href="#cb13-21"></a>knitr<span class="op">::</span><span class="kw">kable</span>(d)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">cf</th>
<th align="right">f</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">n=20</td>
<td align="right">0.372</td>
<td align="right">0.571</td>
</tr>
<tr class="even">
<td align="left">n=200</td>
<td align="right">0.953</td>
<td align="right">0.766</td>
</tr>
<tr class="odd">
<td align="left">n=2000</td>
<td align="right">0.999</td>
<td align="right">0.983</td>
</tr>
<tr class="even">
<td align="left">n=20000</td>
<td align="right">1.000</td>
<td align="right">1.000</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="c" class="section level4">
<h4>6.C</h4>
<div id="example-6.8" class="section level5">
<h5>Example 6.8</h5>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1"></a></span>
<span id="cb14-2"><a href="#cb14-2"></a>sigma&lt;-<span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">5</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">4</span>),<span class="dv">2</span>,<span class="dv">2</span>)</span>
<span id="cb14-3"><a href="#cb14-3"></a>mu&lt;-<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">4</span>)</span>
<span id="cb14-4"><a href="#cb14-4"></a>d&lt;-<span class="dv">2</span></span>
<span id="cb14-5"><a href="#cb14-5"></a>c1&lt;-<span class="kw">qchisq</span>(<span class="fl">0.025</span>,d<span class="op">*</span>(d<span class="op">+</span><span class="dv">1</span>)<span class="op">*</span>(d<span class="op">+</span><span class="dv">2</span>)<span class="op">/</span><span class="dv">6</span>)</span>
<span id="cb14-6"><a href="#cb14-6"></a>c2&lt;-<span class="kw">qchisq</span>(<span class="fl">0.975</span>,d<span class="op">*</span>(d<span class="op">+</span><span class="dv">1</span>)<span class="op">*</span>(d<span class="op">+</span><span class="dv">2</span>)<span class="op">/</span><span class="dv">6</span>)</span>
<span id="cb14-7"><a href="#cb14-7"></a>m&lt;-<span class="dv">1000</span></span>
<span id="cb14-8"><a href="#cb14-8"></a>n&lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">10</span>,<span class="dv">20</span>,<span class="dv">30</span>,<span class="dv">50</span>,<span class="dv">100</span>,<span class="dv">500</span>)<span class="co">#样本量</span></span>
<span id="cb14-9"><a href="#cb14-9"></a>p&lt;-<span class="kw">numeric</span>(<span class="kw">length</span>(n))</span>
<span id="cb14-10"><a href="#cb14-10"></a></span>
<span id="cb14-11"><a href="#cb14-11"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(n)){</span>
<span id="cb14-12"><a href="#cb14-12"></a>  </span>
<span id="cb14-13"><a href="#cb14-13"></a>b&lt;-<span class="kw">replicate</span>(m,<span class="dt">expr=</span>{</span>
<span id="cb14-14"><a href="#cb14-14"></a>               x&lt;-<span class="kw">mvrnorm</span>(n[i],mu,sigma)</span>
<span id="cb14-15"><a href="#cb14-15"></a>               sigmahat&lt;-<span class="kw">var</span>(x)</span>
<span id="cb14-16"><a href="#cb14-16"></a>               y&lt;-<span class="kw">matrix</span>(<span class="kw">c</span>(<span class="kw">mean</span>(x[,<span class="dv">1</span>]),<span class="kw">mean</span>(x[,<span class="dv">2</span>])),n[i],<span class="dv">2</span>,<span class="dt">byrow=</span><span class="ot">TRUE</span>)</span>
<span id="cb14-17"><a href="#cb14-17"></a>               xc&lt;-x<span class="op">-</span>y</span>
<span id="cb14-18"><a href="#cb14-18"></a>               a&lt;-(xc<span class="op">%*%</span><span class="kw">solve</span>(sigmahat)<span class="op">%*%</span><span class="kw">t</span>(xc))<span class="op">^</span><span class="dv">3</span></span>
<span id="cb14-19"><a href="#cb14-19"></a>               <span class="kw">mean</span>(a)</span>
<span id="cb14-20"><a href="#cb14-20"></a>             })</span>
<span id="cb14-21"><a href="#cb14-21"></a>p[i]&lt;-<span class="kw">mean</span>(<span class="kw">as.integer</span>((n[i]<span class="op">*</span>b<span class="op">/</span><span class="dv">6</span><span class="op">&gt;</span>c2)<span class="op">|</span>(n[i]<span class="op">*</span>b<span class="op">/</span><span class="dv">6</span><span class="op">&lt;</span>c1)))</span>
<span id="cb14-22"><a href="#cb14-22"></a>           } </span>
<span id="cb14-23"><a href="#cb14-23"></a>g&lt;-<span class="kw">data.frame</span>(p,<span class="dt">row.names=</span><span class="kw">c</span>(<span class="st">&quot;n=10&quot;</span>,<span class="st">&quot;n=20&quot;</span>,<span class="st">&quot;n=30&quot;</span>,<span class="st">&quot;n=50&quot;</span>,<span class="st">&quot;n=100&quot;</span>,<span class="st">&quot;n=500&quot;</span>))</span>
<span id="cb14-24"><a href="#cb14-24"></a>knitr<span class="op">::</span><span class="kw">kable</span>(g)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">p</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">n=10</td>
<td align="right">0.117</td>
</tr>
<tr class="even">
<td align="left">n=20</td>
<td align="right">0.070</td>
</tr>
<tr class="odd">
<td align="left">n=30</td>
<td align="right">0.071</td>
</tr>
<tr class="even">
<td align="left">n=50</td>
<td align="right">0.047</td>
</tr>
<tr class="odd">
<td align="left">n=100</td>
<td align="right">0.042</td>
</tr>
<tr class="even">
<td align="left">n=500</td>
<td align="right">0.054</td>
</tr>
</tbody>
</table>
</div>
<div id="example-6.10" class="section level5">
<h5>Example 6.10</h5>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1"></a>sigma1&lt;-<span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">5</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">4</span>),<span class="dv">2</span>,<span class="dv">2</span>)</span>
<span id="cb15-2"><a href="#cb15-2"></a>sigma2&lt;-<span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">8</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">1</span>),<span class="dv">2</span>,<span class="dv">2</span>)</span>
<span id="cb15-3"><a href="#cb15-3"></a>mu&lt;-<span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">0</span>)</span>
<span id="cb15-4"><a href="#cb15-4"></a>d&lt;-<span class="dv">2</span></span>
<span id="cb15-5"><a href="#cb15-5"></a>c1&lt;-<span class="kw">qchisq</span>(<span class="fl">0.025</span>,d<span class="op">*</span>(d<span class="op">+</span><span class="dv">1</span>)<span class="op">*</span>(d<span class="op">+</span><span class="dv">2</span>)<span class="op">/</span><span class="dv">6</span>)</span>
<span id="cb15-6"><a href="#cb15-6"></a>c2&lt;-<span class="kw">qchisq</span>(<span class="fl">0.975</span>,d<span class="op">*</span>(d<span class="op">+</span><span class="dv">1</span>)<span class="op">*</span>(d<span class="op">+</span><span class="dv">2</span>)<span class="op">/</span><span class="dv">6</span>)</span>
<span id="cb15-7"><a href="#cb15-7"></a>m&lt;-<span class="dv">1000</span></span>
<span id="cb15-8"><a href="#cb15-8"></a>n&lt;-<span class="dv">30</span></span>
<span id="cb15-9"><a href="#cb15-9"></a>epsilon &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">seq</span>(<span class="dv">0</span>, <span class="fl">.15</span>, <span class="fl">.01</span>), <span class="kw">seq</span>(.<span class="dv">15</span>, <span class="dv">1</span>, <span class="fl">.05</span>))</span>
<span id="cb15-10"><a href="#cb15-10"></a>N &lt;-<span class="st"> </span><span class="kw">length</span>(epsilon)</span>
<span id="cb15-11"><a href="#cb15-11"></a>pwr &lt;-<span class="st"> </span><span class="kw">numeric</span>(N)</span>
<span id="cb15-12"><a href="#cb15-12"></a><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>N) { </span>
<span id="cb15-13"><a href="#cb15-13"></a>e &lt;-<span class="st"> </span>epsilon[j]</span>
<span id="cb15-14"><a href="#cb15-14"></a>b&lt;-<span class="kw">replicate</span>(m,<span class="dt">expr=</span>{</span>
<span id="cb15-15"><a href="#cb15-15"></a>  a &lt;-<span class="st"> </span><span class="kw">sum</span>(<span class="kw">sample</span>(<span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>), <span class="dt">replace =</span> <span class="ot">TRUE</span>,<span class="dt">size =</span> n, <span class="dt">prob =</span> <span class="kw">c</span>(<span class="dv">1</span><span class="op">-</span>e, e)))</span>
<span id="cb15-16"><a href="#cb15-16"></a>           <span class="cf">if</span>(a<span class="op">==</span><span class="dv">0</span>){x&lt;-<span class="kw">mvrnorm</span>(n,mu,sigma1)}</span>
<span id="cb15-17"><a href="#cb15-17"></a>  <span class="cf">else</span> <span class="cf">if</span>(a<span class="op">==</span>n){x&lt;-<span class="kw">mvrnorm</span>(n,mu,sigma2)}</span>
<span id="cb15-18"><a href="#cb15-18"></a><span class="cf">else</span>                {x1 &lt;-<span class="st"> </span><span class="kw">mvrnorm</span>(n<span class="op">-</span>a,mu,sigma1)</span>
<span id="cb15-19"><a href="#cb15-19"></a>                x2 &lt;-<span class="st"> </span><span class="kw">mvrnorm</span>(a,mu,sigma2)</span>
<span id="cb15-20"><a href="#cb15-20"></a>                x &lt;-<span class="st"> </span><span class="kw">rbind</span>(x1,x2)</span>
<span id="cb15-21"><a href="#cb15-21"></a>}</span>
<span id="cb15-22"><a href="#cb15-22"></a>               sigmahat&lt;-<span class="kw">var</span>(x)</span>
<span id="cb15-23"><a href="#cb15-23"></a>               y&lt;-<span class="kw">matrix</span>(<span class="kw">c</span>(<span class="kw">mean</span>(x[,<span class="dv">1</span>]),<span class="kw">mean</span>(x[,<span class="dv">2</span>])),n,<span class="dv">2</span>,<span class="dt">byrow=</span><span class="ot">TRUE</span>)</span>
<span id="cb15-24"><a href="#cb15-24"></a>               xc&lt;-x<span class="op">-</span>y</span>
<span id="cb15-25"><a href="#cb15-25"></a>               bhat&lt;-(xc<span class="op">%*%</span><span class="kw">solve</span>(sigmahat)<span class="op">%*%</span><span class="kw">t</span>(xc))<span class="op">^</span><span class="dv">3</span></span>
<span id="cb15-26"><a href="#cb15-26"></a>               <span class="kw">mean</span>(bhat)</span>
<span id="cb15-27"><a href="#cb15-27"></a>             })</span>
<span id="cb15-28"><a href="#cb15-28"></a> pwr[j] &lt;-<span class="st"> </span><span class="kw">mean</span>(<span class="kw">as.integer</span>((n<span class="op">*</span>b<span class="op">/</span><span class="dv">6</span><span class="op">&lt;</span>c1)<span class="op">|</span>(n<span class="op">*</span>b<span class="op">/</span><span class="dv">6</span><span class="op">&gt;</span>c2)))}</span>
<span id="cb15-29"><a href="#cb15-29"></a></span>
<span id="cb15-30"><a href="#cb15-30"></a><span class="kw">plot</span>(epsilon, pwr, <span class="dt">type=</span><span class="st">&quot;b&quot;</span>,<span class="dt">xlab=</span><span class="kw">bquote</span>(epsilon),<span class="dt">ylim=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="fl">0.5</span>))</span>
<span id="cb15-31"><a href="#cb15-31"></a><span class="kw">abline</span>(<span class="dt">h=</span><span class="fl">0.05</span>, <span class="dt">lty=</span><span class="dv">3</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
</div>
</div>
<div id="discussion" class="section level2">
<h2>Discussion</h2>
<pre><code>  If we obtain the powers for two methods under a particular simulation setting with 10,000 experiments:say.0.651 for one method and 0.676 for another method .Can we say the powers are different at 0.05 level?

    - What is the corresponding hypothesis test problem?
    - What test should we use?Z-test,two-sample t-test,paired-ttest or McNemar test?.
    - What information is needed to test your hypothesis?
    
    </code></pre>
</div>
<div id="answer-5" class="section level2">
<h2>Answer</h2>
<p><span class="math display">\[H_0:P_1=P_2 \Leftrightarrow  H_1:P_1\neq P_2\]</span> 令<span class="math inline">\(X\sim B(n,p_1),Y\sim B(n,p_2)\)</span><span class="math inline">\(EX=np_1,EY=np_2\)</span></p>
</div>
<div id="hw5" class="section level2">
<h2>HW5</h2>
</div>
<div id="question-5" class="section level2">
<h2>Question</h2>
<p>Exercises 7.1, 7.5, 7.8, and 7.11 (pages 212-213, Statistical Computating with R).</p>
</div>
<div id="section-13" class="section level2">
<h2>7.1</h2>
<p>7.1 Compute a jackknife estimate of the bias and the standard error of the correlation statistic in Example 7.2.</p>
</div>
<div id="answer-6" class="section level2">
<h2>Answer</h2>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1"></a>n&lt;-<span class="kw">nrow</span>(law)</span>
<span id="cb17-2"><a href="#cb17-2"></a>thetahat&lt;-<span class="kw">cor</span>(law<span class="op">$</span>LSAT, law<span class="op">$</span>GPA)</span>
<span id="cb17-3"><a href="#cb17-3"></a>thetaj&lt;-LSAT1&lt;-GPA1 &lt;-<span class="st"> </span><span class="kw">numeric</span>(n)</span>
<span id="cb17-4"><a href="#cb17-4"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n){</span>
<span id="cb17-5"><a href="#cb17-5"></a>  thetaj[i]&lt;-<span class="kw">cor</span>(law<span class="op">$</span>LSAT[<span class="op">-</span>i],law<span class="op">$</span>GPA[<span class="op">-</span>i])</span>
<span id="cb17-6"><a href="#cb17-6"></a>}</span>
<span id="cb17-7"><a href="#cb17-7"></a>bias &lt;-<span class="st"> </span>(n <span class="op">-</span><span class="st"> </span><span class="dv">1</span>) <span class="op">*</span><span class="st"> </span>(<span class="kw">mean</span>(thetaj) <span class="op">-</span><span class="st"> </span>thetahat)</span>
<span id="cb17-8"><a href="#cb17-8"></a><span class="kw">cat</span>(<span class="st">&quot;jackknife estimate of bias:&quot;</span>,bias,<span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span>) <span class="co">#jackknife estimate of bias</span></span>
<span id="cb17-9"><a href="#cb17-9"></a><span class="co">#&gt; jackknife estimate of bias: -0.006473623</span></span>
<span id="cb17-10"><a href="#cb17-10"></a></span>
<span id="cb17-11"><a href="#cb17-11"></a>se &lt;-<span class="st"> </span><span class="kw">sqrt</span>((n<span class="dv">-1</span>) <span class="op">*</span><span class="kw">mean</span>((thetaj <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(thetaj))<span class="op">^</span><span class="dv">2</span>))</span>
<span id="cb17-12"><a href="#cb17-12"></a><span class="kw">cat</span>(<span class="st">&quot;the standard error of the correlation:&quot;</span>,se,<span class="st">&quot;&quot;</span>)</span>
<span id="cb17-13"><a href="#cb17-13"></a><span class="co">#&gt; the standard error of the correlation: 0.1425186</span></span></code></pre></div>
</div>
<div id="section-14" class="section level2">
<h2>7.5</h2>
<p>7.5 Refer to Exercise 7.4. Compute 95% bootstrap confidence intervals for the mean time between failures 1/λ by the standard normal, basic, percentile, and BCa methods. Compare the intervals and explain why they may differ.</p>
<p>##Answer</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1"></a>theta.boot &lt;-<span class="st"> </span><span class="cf">function</span>(dat,ind) {</span>
<span id="cb18-2"><a href="#cb18-2"></a><span class="co">#function to compute the statistic</span></span>
<span id="cb18-3"><a href="#cb18-3"></a>  y &lt;-<span class="st"> </span>dat[ind,<span class="dv">1</span>]</span>
<span id="cb18-4"><a href="#cb18-4"></a>  <span class="kw">mean</span>(y) </span>
<span id="cb18-5"><a href="#cb18-5"></a>}</span>
<span id="cb18-6"><a href="#cb18-6"></a><span class="kw">data</span>(aircondit,<span class="dt">package=</span><span class="st">&quot;boot&quot;</span>)</span>
<span id="cb18-7"><a href="#cb18-7"></a>boot.obj &lt;-<span class="st"> </span><span class="kw">boot</span>(aircondit, <span class="dt">statistic =</span>theta.boot , <span class="dt">R =</span> <span class="dv">2000</span>)</span>
<span id="cb18-8"><a href="#cb18-8"></a><span class="kw">print</span>(<span class="kw">boot.ci</span>(boot.obj,<span class="dt">type =</span> <span class="kw">c</span>(<span class="st">&quot;basic&quot;</span>,<span class="st">&quot;norm&quot;</span>,<span class="st">&quot;perc&quot;</span>,<span class="st">&quot;bca&quot;</span>)))</span>
<span id="cb18-9"><a href="#cb18-9"></a><span class="co">#&gt; BOOTSTRAP CONFIDENCE INTERVAL CALCULATIONS</span></span>
<span id="cb18-10"><a href="#cb18-10"></a><span class="co">#&gt; Based on 2000 bootstrap replicates</span></span>
<span id="cb18-11"><a href="#cb18-11"></a><span class="co">#&gt; </span></span>
<span id="cb18-12"><a href="#cb18-12"></a><span class="co">#&gt; CALL : </span></span>
<span id="cb18-13"><a href="#cb18-13"></a><span class="co">#&gt; boot.ci(boot.out = boot.obj, type = c(&quot;basic&quot;, &quot;norm&quot;, &quot;perc&quot;, </span></span>
<span id="cb18-14"><a href="#cb18-14"></a><span class="co">#&gt;     &quot;bca&quot;))</span></span>
<span id="cb18-15"><a href="#cb18-15"></a><span class="co">#&gt; </span></span>
<span id="cb18-16"><a href="#cb18-16"></a><span class="co">#&gt; Intervals : </span></span>
<span id="cb18-17"><a href="#cb18-17"></a><span class="co">#&gt; Level      Normal              Basic         </span></span>
<span id="cb18-18"><a href="#cb18-18"></a><span class="co">#&gt; 95%   ( 33.7, 181.7 )   ( 24.9, 169.0 )  </span></span>
<span id="cb18-19"><a href="#cb18-19"></a><span class="co">#&gt; </span></span>
<span id="cb18-20"><a href="#cb18-20"></a><span class="co">#&gt; Level     Percentile            BCa          </span></span>
<span id="cb18-21"><a href="#cb18-21"></a><span class="co">#&gt; 95%   ( 47.2, 191.2 )   ( 56.6, 230.9 )  </span></span>
<span id="cb18-22"><a href="#cb18-22"></a><span class="co">#&gt; Calculations and Intervals on Original Scale</span></span>
<span id="cb18-23"><a href="#cb18-23"></a><span class="co">#&gt; Some BCa intervals may be unstable</span></span>
<span id="cb18-24"><a href="#cb18-24"></a><span class="co">#calculations for bootstrap confidence intervals</span></span>
<span id="cb18-25"><a href="#cb18-25"></a>alpha &lt;-<span class="st"> </span><span class="kw">c</span>(.<span class="dv">025</span>, <span class="fl">.975</span>)</span>
<span id="cb18-26"><a href="#cb18-26"></a></span>
<span id="cb18-27"><a href="#cb18-27"></a><span class="co">#normal</span></span>
<span id="cb18-28"><a href="#cb18-28"></a><span class="kw">print</span>(boot.obj<span class="op">$</span>t0 <span class="op">+</span><span class="st"> </span><span class="kw">qnorm</span>(alpha )<span class="op">*</span><span class="st"> </span><span class="kw">sd</span>(boot.obj<span class="op">$</span>t))</span>
<span id="cb18-29"><a href="#cb18-29"></a><span class="co">#&gt; [1]  34.07774 182.08893</span></span>
<span id="cb18-30"><a href="#cb18-30"></a></span>
<span id="cb18-31"><a href="#cb18-31"></a></span>
<span id="cb18-32"><a href="#cb18-32"></a><span class="co">#basic</span></span>
<span id="cb18-33"><a href="#cb18-33"></a><span class="kw">print</span>(<span class="dv">2</span><span class="op">*</span>boot.obj<span class="op">$</span>t0 <span class="op">-</span><span class="kw">quantile</span>(boot.obj<span class="op">$</span>t, <span class="kw">rev</span>(alpha), <span class="dt">type=</span><span class="dv">1</span>))</span>
<span id="cb18-34"><a href="#cb18-34"></a><span class="co">#&gt; 97.5%  2.5% </span></span>
<span id="cb18-35"><a href="#cb18-35"></a><span class="co">#&gt;    25   169</span></span>
<span id="cb18-36"><a href="#cb18-36"></a></span>
<span id="cb18-37"><a href="#cb18-37"></a><span class="co">#percentile</span></span>
<span id="cb18-38"><a href="#cb18-38"></a><span class="kw">print</span>(<span class="kw">quantile</span>(boot.obj<span class="op">$</span>t, alpha, <span class="dt">type=</span><span class="dv">6</span>))</span>
<span id="cb18-39"><a href="#cb18-39"></a><span class="co">#&gt;      2.5%     97.5% </span></span>
<span id="cb18-40"><a href="#cb18-40"></a><span class="co">#&gt;  47.17083 191.24792</span></span></code></pre></div>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1"></a> boot.BCa &lt;-<span class="cf">function</span>(x, th0, th,  <span class="dt">conf =</span> <span class="fl">.95</span>) {</span>
<span id="cb19-2"><a href="#cb19-2"></a><span class="co"># bootstrap with BCa bootstrap confidence interval</span></span>
<span id="cb19-3"><a href="#cb19-3"></a><span class="co"># th0 is the observed statistic</span></span>
<span id="cb19-4"><a href="#cb19-4"></a><span class="co"># th is the vector of bootstrap replicates</span></span>
<span id="cb19-5"><a href="#cb19-5"></a> x &lt;-<span class="st"> </span><span class="kw">as.matrix</span>(x)</span>
<span id="cb19-6"><a href="#cb19-6"></a> n &lt;-<span class="st"> </span><span class="kw">nrow</span>(x) <span class="co">#observations in rows</span></span>
<span id="cb19-7"><a href="#cb19-7"></a> N &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">:</span>n</span>
<span id="cb19-8"><a href="#cb19-8"></a> alpha &lt;-<span class="st"> </span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span><span class="kw">c</span>(<span class="op">-</span>conf, conf))<span class="op">/</span><span class="dv">2</span></span>
<span id="cb19-9"><a href="#cb19-9"></a> zalpha &lt;-<span class="st"> </span><span class="kw">qnorm</span>(alpha)</span>
<span id="cb19-10"><a href="#cb19-10"></a><span class="co"># the bias correction factor</span></span>
<span id="cb19-11"><a href="#cb19-11"></a> z0 &lt;-<span class="st"> </span><span class="kw">qnorm</span>(<span class="kw">sum</span>(th <span class="op">&lt;</span><span class="st"> </span>th0) <span class="op">/</span><span class="st"> </span><span class="kw">length</span>(th))</span>
<span id="cb19-12"><a href="#cb19-12"></a><span class="co"># the acceleration factor (jackknife est.)</span></span>
<span id="cb19-13"><a href="#cb19-13"></a> th.jack &lt;-<span class="st"> </span><span class="kw">numeric</span>(n)</span>
<span id="cb19-14"><a href="#cb19-14"></a> <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n) {</span>
<span id="cb19-15"><a href="#cb19-15"></a> </span>
<span id="cb19-16"><a href="#cb19-16"></a> th.jack[i] &lt;-<span class="st"> </span><span class="kw">mean</span>(x[<span class="op">-</span>i, ])</span>
<span id="cb19-17"><a href="#cb19-17"></a>}</span>
<span id="cb19-18"><a href="#cb19-18"></a> L &lt;-<span class="st"> </span><span class="kw">mean</span>(th.jack) <span class="op">-</span><span class="st"> </span>th.jack</span>
<span id="cb19-19"><a href="#cb19-19"></a> a &lt;-<span class="st"> </span><span class="kw">sum</span>(L<span class="op">^</span><span class="dv">3</span>)<span class="op">/</span>(<span class="dv">6</span> <span class="op">*</span><span class="st"> </span><span class="kw">sum</span>(L<span class="op">^</span><span class="dv">2</span>)<span class="op">^</span><span class="fl">1.5</span>)</span>
<span id="cb19-20"><a href="#cb19-20"></a><span class="co"># BCa conf. limits</span></span>
<span id="cb19-21"><a href="#cb19-21"></a> adj.alpha &lt;-<span class="st"> </span><span class="kw">pnorm</span>(z0 <span class="op">+</span><span class="st"> </span>(z0<span class="op">+</span>zalpha)<span class="op">/</span>(<span class="dv">1</span><span class="op">-</span>a<span class="op">*</span>(z0<span class="op">+</span>zalpha)))</span>
<span id="cb19-22"><a href="#cb19-22"></a> limits &lt;-<span class="st"> </span><span class="kw">quantile</span>(th, adj.alpha, <span class="dt">type=</span><span class="dv">6</span>)</span>
<span id="cb19-23"><a href="#cb19-23"></a> <span class="kw">return</span>(<span class="kw">list</span>(<span class="st">&quot;est&quot;</span>=th0, <span class="st">&quot;BCa&quot;</span>=limits))</span>
<span id="cb19-24"><a href="#cb19-24"></a> }</span>
<span id="cb19-25"><a href="#cb19-25"></a></span>
<span id="cb19-26"><a href="#cb19-26"></a><span class="kw">data</span>(aircondit,<span class="dt">package=</span><span class="st">&quot;boot&quot;</span>)</span>
<span id="cb19-27"><a href="#cb19-27"></a>B &lt;-<span class="st"> </span><span class="dv">2000</span></span>
<span id="cb19-28"><a href="#cb19-28"></a>n&lt;-<span class="kw">nrow</span>(aircondit)</span>
<span id="cb19-29"><a href="#cb19-29"></a>theta.b &lt;-<span class="st"> </span><span class="kw">numeric</span>(B)</span>
<span id="cb19-30"><a href="#cb19-30"></a>theta.hat &lt;-<span class="st"> </span><span class="kw">mean</span>(aircondit[,<span class="dv">1</span>])</span>
<span id="cb19-31"><a href="#cb19-31"></a></span>
<span id="cb19-32"><a href="#cb19-32"></a><span class="co">#bootstrap</span></span>
<span id="cb19-33"><a href="#cb19-33"></a><span class="cf">for</span> (b <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>B) {</span>
<span id="cb19-34"><a href="#cb19-34"></a>i &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="dv">1</span><span class="op">:</span>n, <span class="dt">size =</span> n, <span class="dt">replace =</span> <span class="ot">TRUE</span>)</span>
<span id="cb19-35"><a href="#cb19-35"></a>y &lt;-<span class="st"> </span>aircondit[i,]</span>
<span id="cb19-36"><a href="#cb19-36"></a>theta.b[b] &lt;-<span class="st"> </span><span class="kw">mean</span>(y) }</span>
<span id="cb19-37"><a href="#cb19-37"></a></span>
<span id="cb19-38"><a href="#cb19-38"></a><span class="co">#compute the BCa interval</span></span>
<span id="cb19-39"><a href="#cb19-39"></a><span class="kw">boot.BCa</span>(aircondit, <span class="dt">th0 =</span> theta.hat, <span class="dt">th =</span> theta.b)</span>
<span id="cb19-40"><a href="#cb19-40"></a><span class="co">#&gt; $est</span></span>
<span id="cb19-41"><a href="#cb19-41"></a><span class="co">#&gt; [1] 108.0833</span></span>
<span id="cb19-42"><a href="#cb19-42"></a><span class="co">#&gt; </span></span>
<span id="cb19-43"><a href="#cb19-43"></a><span class="co">#&gt; $BCa</span></span>
<span id="cb19-44"><a href="#cb19-44"></a><span class="co">#&gt; 6.991754% 99.61392% </span></span>
<span id="cb19-45"><a href="#cb19-45"></a><span class="co">#&gt;  58.08333 226.94832</span></span></code></pre></div>
</div>
<div id="section-15" class="section level2">
<h2>7.8</h2>
<p>7.8 Refer to Exercise 7.7. Obtain the jackknife estimates of bias and standard error of <span class="math inline">\(\hat{\theta}\)</span>.</p>
</div>
<div id="answer-7" class="section level2">
<h2>Answer</h2>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1"></a><span class="kw">data</span>(scor,<span class="dt">package=</span><span class="st">&quot;bootstrap&quot;</span>)</span>
<span id="cb20-2"><a href="#cb20-2"></a>sigma&lt;-<span class="kw">cov</span>(scor)<span class="co"># MLE of covariance matrix</span></span>
<span id="cb20-3"><a href="#cb20-3"></a>eig&lt;-<span class="kw">eigen</span>(sigma)</span>
<span id="cb20-4"><a href="#cb20-4"></a>e&lt;-<span class="kw">sum</span>(eig<span class="op">$</span>values)</span>
<span id="cb20-5"><a href="#cb20-5"></a>thetahat&lt;-(eig<span class="op">$</span>values[<span class="dv">1</span>])<span class="op">/</span>e</span>
<span id="cb20-6"><a href="#cb20-6"></a></span>
<span id="cb20-7"><a href="#cb20-7"></a><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(scor)){</span>
<span id="cb20-8"><a href="#cb20-8"></a>  c&lt;-<span class="kw">cov</span>(scor[<span class="op">-</span>j,])</span>
<span id="cb20-9"><a href="#cb20-9"></a>  thetaj[j]&lt;-(<span class="kw">eigen</span>(c)<span class="op">$</span>values[<span class="dv">1</span>])<span class="op">/</span><span class="kw">sum</span>(<span class="kw">eigen</span>(c)<span class="op">$</span>values)</span>
<span id="cb20-10"><a href="#cb20-10"></a>}</span>
<span id="cb20-11"><a href="#cb20-11"></a>bias &lt;-<span class="st"> </span>(n <span class="op">-</span><span class="st"> </span><span class="dv">1</span>) <span class="op">*</span><span class="st"> </span>(<span class="kw">mean</span>(thetaj) <span class="op">-</span><span class="st"> </span>thetahat)</span>
<span id="cb20-12"><a href="#cb20-12"></a><span class="kw">cat</span>(<span class="st">&quot;jackknife estimate of bias:&quot;</span>,bias,<span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span>) <span class="co">#jackknife estimate of bias</span></span>
<span id="cb20-13"><a href="#cb20-13"></a><span class="co">#&gt; jackknife estimate of bias: 0.0001351785</span></span>
<span id="cb20-14"><a href="#cb20-14"></a></span>
<span id="cb20-15"><a href="#cb20-15"></a>se &lt;-<span class="st"> </span><span class="kw">sqrt</span>((n<span class="dv">-1</span>) <span class="op">*</span><span class="kw">mean</span>((thetaj <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(thetaj))<span class="op">^</span><span class="dv">2</span>))</span>
<span id="cb20-16"><a href="#cb20-16"></a><span class="kw">cat</span>(<span class="st">&quot;the standard error of the correlation:&quot;</span>,se,<span class="st">&quot;&quot;</span>)</span>
<span id="cb20-17"><a href="#cb20-17"></a><span class="co">#&gt; the standard error of the correlation: 0.01761978</span></span></code></pre></div>
</div>
<div id="question-6" class="section level2">
<h2>Question</h2>
<p>7.11 In Example 7.18, leave-one-out (n-fold) cross validation was used to select the best fitting model. Use leave-two-out cross validation to compare the models.</p>
</div>
<div id="answer-8" class="section level2">
<h2>Answer</h2>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1"></a><span class="kw">attach</span>(ironslag)</span>
<span id="cb21-2"><a href="#cb21-2"></a>n &lt;-<span class="st"> </span><span class="kw">length</span>(magnetic) <span class="co">#in DAAG ironslag</span></span>
<span id="cb21-3"><a href="#cb21-3"></a>e1&lt;-e2&lt;-e3&lt;-e4&lt;-e11&lt;-e22&lt;-e33&lt;-e44&lt;-<span class="kw">matrix</span>(<span class="dv">0</span>,n,n<span class="dv">-1</span>)</span>
<span id="cb21-4"><a href="#cb21-4"></a></span>
<span id="cb21-5"><a href="#cb21-5"></a><span class="cf">for</span> (k <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>(n<span class="dv">-1</span>)) {</span>
<span id="cb21-6"><a href="#cb21-6"></a>  x&lt;-chemical[<span class="op">-</span>k]</span>
<span id="cb21-7"><a href="#cb21-7"></a>  y&lt;-magnetic[<span class="op">-</span>k]</span>
<span id="cb21-8"><a href="#cb21-8"></a>  <span class="cf">for</span>(j <span class="cf">in</span> k<span class="op">:</span>(n<span class="dv">-1</span>)){</span>
<span id="cb21-9"><a href="#cb21-9"></a>  x1&lt;-x[<span class="op">-</span>j]</span>
<span id="cb21-10"><a href="#cb21-10"></a>  y1&lt;-y[<span class="op">-</span>j]</span>
<span id="cb21-11"><a href="#cb21-11"></a>  </span>
<span id="cb21-12"><a href="#cb21-12"></a>  J1 &lt;-<span class="st"> </span><span class="kw">lm</span>(y1 <span class="op">~</span><span class="st"> </span>x1)</span>
<span id="cb21-13"><a href="#cb21-13"></a>  yhat1 &lt;-<span class="st"> </span>J1<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>J1<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>chemical[k]</span>
<span id="cb21-14"><a href="#cb21-14"></a>  yhat11&lt;-J1<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>J1<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>x[j]</span>
<span id="cb21-15"><a href="#cb21-15"></a>  e1[k,j] &lt;-<span class="st"> </span>magnetic[k] <span class="op">-</span><span class="st"> </span>yhat1</span>
<span id="cb21-16"><a href="#cb21-16"></a>  e11[k,j]&lt;-x[j]<span class="op">-</span>yhat11</span>
<span id="cb21-17"><a href="#cb21-17"></a>  </span>
<span id="cb21-18"><a href="#cb21-18"></a>  J2 &lt;-<span class="st"> </span><span class="kw">lm</span>(y1 <span class="op">~</span><span class="st"> </span>x1 <span class="op">+</span><span class="st"> </span><span class="kw">I</span>(x1<span class="op">^</span><span class="dv">2</span>))</span>
<span id="cb21-19"><a href="#cb21-19"></a>  yhat2 &lt;-<span class="st"> </span>J2<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>J2<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>chemical[k] <span class="op">+</span>J2<span class="op">$</span>coef[<span class="dv">3</span>] <span class="op">*</span><span class="st"> </span>chemical[k]<span class="op">^</span><span class="dv">2</span></span>
<span id="cb21-20"><a href="#cb21-20"></a>  yhat22 &lt;-<span class="st"> </span>J2<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>J2<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>x[j] <span class="op">+</span>J2<span class="op">$</span>coef[<span class="dv">3</span>] <span class="op">*</span><span class="st"> </span>x[j]<span class="op">^</span><span class="dv">2</span></span>
<span id="cb21-21"><a href="#cb21-21"></a>  e2[k,j] &lt;-<span class="st"> </span>magnetic[k] <span class="op">-</span><span class="st"> </span>yhat2</span>
<span id="cb21-22"><a href="#cb21-22"></a>  e22[k,j]&lt;-x[j]<span class="op">-</span>yhat22</span>
<span id="cb21-23"><a href="#cb21-23"></a>  </span>
<span id="cb21-24"><a href="#cb21-24"></a>  J3 &lt;-<span class="st"> </span><span class="kw">lm</span>(<span class="kw">log</span>(y1) <span class="op">~</span><span class="st"> </span>x1)</span>
<span id="cb21-25"><a href="#cb21-25"></a>  logyhat3 &lt;-<span class="st"> </span>J3<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>J3<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>chemical[k]</span>
<span id="cb21-26"><a href="#cb21-26"></a>  logyhat33 &lt;-<span class="st"> </span>J3<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>J3<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>x[j]</span>
<span id="cb21-27"><a href="#cb21-27"></a>  yhat3 &lt;-<span class="st"> </span><span class="kw">exp</span>(logyhat3)</span>
<span id="cb21-28"><a href="#cb21-28"></a>  yhat33 &lt;-<span class="st"> </span><span class="kw">exp</span>(logyhat33)</span>
<span id="cb21-29"><a href="#cb21-29"></a>  e3[k,j] &lt;-chemical[k]<span class="op">-</span>yhat3</span>
<span id="cb21-30"><a href="#cb21-30"></a>  e33[k,j]&lt;-x[j]<span class="op">-</span>yhat33</span>
<span id="cb21-31"><a href="#cb21-31"></a>  </span>
<span id="cb21-32"><a href="#cb21-32"></a>  J4 &lt;-<span class="st"> </span><span class="kw">lm</span>(<span class="kw">log</span>(y1) <span class="op">~</span><span class="st"> </span><span class="kw">log</span>(x1))</span>
<span id="cb21-33"><a href="#cb21-33"></a>  logyhat4 &lt;-<span class="st"> </span>J4<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>J4<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span><span class="kw">log</span>(chemical[k])</span>
<span id="cb21-34"><a href="#cb21-34"></a>    logyhat44 &lt;-<span class="st"> </span>J4<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>J4<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span><span class="kw">log</span>(x[j])</span>
<span id="cb21-35"><a href="#cb21-35"></a>  yhat4 &lt;-<span class="st"> </span><span class="kw">exp</span>(logyhat4)</span>
<span id="cb21-36"><a href="#cb21-36"></a>  yhat44 &lt;-<span class="kw">exp</span>(logyhat44)</span>
<span id="cb21-37"><a href="#cb21-37"></a>  e4[k,j]&lt;-<span class="st"> </span>magnetic[k] <span class="op">-</span><span class="st"> </span>yhat4</span>
<span id="cb21-38"><a href="#cb21-38"></a>  e44[k,j]&lt;-x[j]<span class="op">-</span>yhat44</span>
<span id="cb21-39"><a href="#cb21-39"></a>  }</span>
<span id="cb21-40"><a href="#cb21-40"></a>  }</span>
<span id="cb21-41"><a href="#cb21-41"></a><span class="kw">cat</span>(<span class="st">&quot;the prediction error of J1:&quot;</span>,<span class="kw">mean</span>(e1<span class="op">^</span><span class="dv">2</span><span class="op">+</span>e11<span class="op">^</span><span class="dv">2</span>),<span class="st">&quot;</span><span class="ch">\n</span><span class="st">the prediction error of J2:&quot;</span>,<span class="kw">mean</span>(e2<span class="op">^</span><span class="dv">2</span><span class="op">+</span>e22<span class="op">^</span><span class="dv">2</span>),<span class="st">&quot;</span><span class="ch">\n</span><span class="st">the prediction error of J3:&quot;</span>,<span class="kw">mean</span>(e3<span class="op">^</span><span class="dv">2</span><span class="op">+</span>e33<span class="op">^</span><span class="dv">2</span>),<span class="st">&quot;</span><span class="ch">\n</span><span class="st">the prediction error of J4:&quot;</span>,<span class="kw">mean</span>(e4<span class="op">^</span><span class="dv">2</span><span class="op">+</span>e44<span class="op">^</span><span class="dv">2</span>),<span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span>)</span>
<span id="cb21-42"><a href="#cb21-42"></a><span class="co">#&gt; the prediction error of J1: 7.355436 </span></span>
<span id="cb21-43"><a href="#cb21-43"></a><span class="co">#&gt; the prediction error of J2: 7.522752 </span></span>
<span id="cb21-44"><a href="#cb21-44"></a><span class="co">#&gt; the prediction error of J3: 1.507089 </span></span>
<span id="cb21-45"><a href="#cb21-45"></a><span class="co">#&gt; the prediction error of J4: 7.921581</span></span></code></pre></div>
<p>According to the prediction error criterion, Model 3, the exponential model, would be the best fit for the data.</p>
</div>
<div id="hw6" class="section level2">
<h2>HW6</h2>
</div>
<div id="question-7" class="section level2">
<h2>Question</h2>
<p>Exercise 8.3 (page 243, Statistical Computating with R).</p>
<div id="question-8" class="section level4">
<h4>Question</h4>
<p>8.3 The Count 5 test for equal variances in Section 6.4 is based on the maximum number of extreme points. Example 6.15 shows that the Count 5 criterion is not applicable for unequal sample sizes. Implement a permutation test for equal variance based on the maximum number of extreme points that applies when sample sizes are not necessarily equal.</p>
</div>
</div>
<div id="answer-9" class="section level2">
<h2>Answer</h2>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1"></a>count5test &lt;-<span class="st"> </span><span class="cf">function</span>(x, y) {</span>
<span id="cb22-2"><a href="#cb22-2"></a>X &lt;-<span class="st"> </span>x <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(x)</span>
<span id="cb22-3"><a href="#cb22-3"></a>Y &lt;-<span class="st"> </span>y <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(y)</span>
<span id="cb22-4"><a href="#cb22-4"></a>outx &lt;-<span class="st"> </span><span class="kw">sum</span>(X <span class="op">&gt;</span><span class="st"> </span><span class="kw">max</span>(Y)) <span class="op">+</span><span class="st"> </span><span class="kw">sum</span>(X <span class="op">&lt;</span><span class="st"> </span><span class="kw">min</span>(Y))</span>
<span id="cb22-5"><a href="#cb22-5"></a>outy &lt;-<span class="st"> </span><span class="kw">sum</span>(Y <span class="op">&gt;</span><span class="st"> </span><span class="kw">max</span>(X)) <span class="op">+</span><span class="st"> </span><span class="kw">sum</span>(Y <span class="op">&lt;</span><span class="st"> </span><span class="kw">min</span>(X))</span>
<span id="cb22-6"><a href="#cb22-6"></a><span class="co"># return 1 (reject) or 0 (do not reject H0)</span></span>
<span id="cb22-7"><a href="#cb22-7"></a><span class="kw">return</span>(<span class="kw">as.integer</span>(<span class="kw">max</span>(<span class="kw">c</span>(outx, outy)) <span class="op">&gt;</span><span class="st"> </span><span class="dv">5</span>))</span>
<span id="cb22-8"><a href="#cb22-8"></a>}</span>
<span id="cb22-9"><a href="#cb22-9"></a><span class="kw">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb22-10"><a href="#cb22-10"></a>R&lt;-<span class="dv">1000</span></span>
<span id="cb22-11"><a href="#cb22-11"></a>n1&lt;-<span class="dv">20</span></span>
<span id="cb22-12"><a href="#cb22-12"></a>n2&lt;-<span class="dv">30</span></span>
<span id="cb22-13"><a href="#cb22-13"></a>x&lt;-<span class="kw">rnorm</span>(n1,<span class="dv">0</span>,<span class="dv">1</span>)</span>
<span id="cb22-14"><a href="#cb22-14"></a>y&lt;-<span class="kw">rnorm</span>(n2,<span class="dv">0</span>,<span class="dv">1</span>)</span>
<span id="cb22-15"><a href="#cb22-15"></a>c&lt;-<span class="kw">numeric</span>(R)</span>
<span id="cb22-16"><a href="#cb22-16"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>R){</span>
<span id="cb22-17"><a href="#cb22-17"></a>  a&lt;-<span class="kw">sample</span>(y,<span class="dt">size=</span><span class="dv">5</span>,<span class="dt">replace=</span><span class="ot">FALSE</span>)</span>
<span id="cb22-18"><a href="#cb22-18"></a>  xx&lt;-<span class="kw">c</span>(x,a)</span>
<span id="cb22-19"><a href="#cb22-19"></a>  yy&lt;-<span class="kw">setdiff</span>(y,a)</span>
<span id="cb22-20"><a href="#cb22-20"></a>  c[i]&lt;-<span class="kw">count5test</span>(xx,yy)</span>
<span id="cb22-21"><a href="#cb22-21"></a>}</span>
<span id="cb22-22"><a href="#cb22-22"></a>p&lt;-<span class="kw">mean</span>(c)</span>
<span id="cb22-23"><a href="#cb22-23"></a>p</span>
<span id="cb22-24"><a href="#cb22-24"></a><span class="co">#&gt; [1] 0.015</span></span></code></pre></div>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1"></a><span class="co">#方差不等的情况下</span></span>
<span id="cb23-2"><a href="#cb23-2"></a><span class="kw">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb23-3"><a href="#cb23-3"></a>R&lt;-<span class="dv">1000</span></span>
<span id="cb23-4"><a href="#cb23-4"></a>n1&lt;-<span class="dv">20</span></span>
<span id="cb23-5"><a href="#cb23-5"></a>n2&lt;-<span class="dv">30</span></span>
<span id="cb23-6"><a href="#cb23-6"></a>x1&lt;-<span class="kw">rnorm</span>(n1,<span class="dv">0</span>,<span class="dv">1</span>)</span>
<span id="cb23-7"><a href="#cb23-7"></a>y1&lt;-<span class="kw">rnorm</span>(n2,<span class="dv">0</span>,<span class="dv">5</span>)</span>
<span id="cb23-8"><a href="#cb23-8"></a>c1&lt;-<span class="kw">numeric</span>(R)</span>
<span id="cb23-9"><a href="#cb23-9"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>R){</span>
<span id="cb23-10"><a href="#cb23-10"></a>  a&lt;-<span class="kw">sample</span>(y1,<span class="dt">size=</span><span class="dv">5</span>,<span class="dt">replace=</span><span class="ot">FALSE</span>)</span>
<span id="cb23-11"><a href="#cb23-11"></a>  xx1&lt;-<span class="kw">c</span>(x1,a)</span>
<span id="cb23-12"><a href="#cb23-12"></a>  yy1&lt;-<span class="kw">setdiff</span>(y1,a)</span>
<span id="cb23-13"><a href="#cb23-13"></a>  c1[i]&lt;-<span class="kw">count5test</span>(xx1,yy1)</span>
<span id="cb23-14"><a href="#cb23-14"></a>}</span>
<span id="cb23-15"><a href="#cb23-15"></a>p1&lt;-<span class="kw">mean</span>(c1)</span>
<span id="cb23-16"><a href="#cb23-16"></a>p1</span>
<span id="cb23-17"><a href="#cb23-17"></a><span class="co">#&gt; [1] 0.563</span></span></code></pre></div>
</div>
<div id="question-9" class="section level2">
<h2>Question</h2>
<ul>
<li>Design experiments for evaluating the performance of the NN,energy, and ball methods in various situations.</li>
<li>Unequal variances and equal expectations</li>
<li>Unequal variances and unequal expectations</li>
<li>Non-normal distributions: t distribution with 1 df (heavy-tailed distribution), bimodel distribution (mixture of two normal distributions)</li>
<li>Unbalanced samples (say, 1 case versus 10 controls)</li>
<li>Note: The parameters should be chosen such that the powers are distinguishable (say, range from 0.3 to 0.8).</li>
</ul>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1"></a>Tn &lt;-<span class="st"> </span><span class="cf">function</span>(z, ix, sizes,k) {</span>
<span id="cb24-2"><a href="#cb24-2"></a>  n1 &lt;-<span class="st"> </span>sizes[<span class="dv">1</span>]; n2 &lt;-<span class="st"> </span>sizes[<span class="dv">2</span>]; n &lt;-<span class="st"> </span>n1 <span class="op">+</span><span class="st"> </span>n2</span>
<span id="cb24-3"><a href="#cb24-3"></a>  <span class="cf">if</span>(<span class="kw">is.vector</span>(z)) z &lt;-<span class="st"> </span><span class="kw">data.frame</span>(z,<span class="dv">0</span>);</span>
<span id="cb24-4"><a href="#cb24-4"></a>  z &lt;-<span class="st"> </span>z[ix, ];</span>
<span id="cb24-5"><a href="#cb24-5"></a>  NN &lt;-<span class="st"> </span><span class="kw">nn2</span>(<span class="dt">data=</span>z, <span class="dt">k=</span>k<span class="op">+</span><span class="dv">1</span>) </span>
<span id="cb24-6"><a href="#cb24-6"></a>  block1 &lt;-<span class="st"> </span>NN<span class="op">$</span>nn.idx[<span class="dv">1</span><span class="op">:</span>n1,<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb24-7"><a href="#cb24-7"></a>  block2 &lt;-<span class="st"> </span>NN<span class="op">$</span>nn.idx[(n1<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>n,<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb24-8"><a href="#cb24-8"></a>  i1 &lt;-<span class="st"> </span><span class="kw">sum</span>(block1 <span class="op">&lt;</span><span class="st"> </span>n1 <span class="op">+</span><span class="st"> </span><span class="fl">.5</span>); i2 &lt;-<span class="st"> </span><span class="kw">sum</span>(block2 <span class="op">&gt;</span><span class="st"> </span>n1<span class="fl">+.5</span>)</span>
<span id="cb24-9"><a href="#cb24-9"></a>  (i1 <span class="op">+</span><span class="st"> </span>i2) <span class="op">/</span><span class="st"> </span>(k <span class="op">*</span><span class="st"> </span>n)</span>
<span id="cb24-10"><a href="#cb24-10"></a>}</span>
<span id="cb24-11"><a href="#cb24-11"></a></span>
<span id="cb24-12"><a href="#cb24-12"></a>eqdist.nn &lt;-<span class="st"> </span><span class="cf">function</span>(z,sizes,k){</span>
<span id="cb24-13"><a href="#cb24-13"></a>  boot.obj &lt;-<span class="st"> </span><span class="kw">boot</span>(<span class="dt">data=</span>z,<span class="dt">statistic=</span>Tn,<span class="dt">R=</span>R,<span class="dt">sim =</span> <span class="st">&quot;permutation&quot;</span>, <span class="dt">sizes =</span> sizes,<span class="dt">k=</span>k)</span>
<span id="cb24-14"><a href="#cb24-14"></a>  ts &lt;-<span class="st"> </span><span class="kw">c</span>(boot.obj<span class="op">$</span>t0,boot.obj<span class="op">$</span>t)</span>
<span id="cb24-15"><a href="#cb24-15"></a>  p.value &lt;-<span class="st"> </span><span class="kw">mean</span>(ts<span class="op">&gt;=</span>ts[<span class="dv">1</span>])</span>
<span id="cb24-16"><a href="#cb24-16"></a>  <span class="kw">list</span>(<span class="dt">statistic=</span>ts[<span class="dv">1</span>],<span class="dt">p.value=</span>p.value)</span>
<span id="cb24-17"><a href="#cb24-17"></a>}</span>
<span id="cb24-18"><a href="#cb24-18"></a>  </span>
<span id="cb24-19"><a href="#cb24-19"></a></span>
<span id="cb24-20"><a href="#cb24-20"></a>m &lt;-<span class="st"> </span><span class="dv">1000</span>; k&lt;-<span class="dv">3</span></span>
<span id="cb24-21"><a href="#cb24-21"></a>n1 &lt;-<span class="st"> </span>n2 &lt;-<span class="st"> </span><span class="dv">50</span>; R&lt;-<span class="dv">99</span></span>
<span id="cb24-22"><a href="#cb24-22"></a>N&lt;-<span class="kw">c</span>(n1,n2)</span>
<span id="cb24-23"><a href="#cb24-23"></a>p1&lt;-p2&lt;-p3&lt;-p4&lt;-p5&lt;-p6&lt;-<span class="kw">matrix</span>(<span class="ot">NA</span>,m,<span class="dv">3</span>)</span>
<span id="cb24-24"><a href="#cb24-24"></a></span>
<span id="cb24-25"><a href="#cb24-25"></a><span class="co">#Unequal variances and equal expectations</span></span>
<span id="cb24-26"><a href="#cb24-26"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){</span>
<span id="cb24-27"><a href="#cb24-27"></a>  x1 &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">rnorm</span>(<span class="dv">100</span>,<span class="dt">mean=</span><span class="fl">0.5</span>,<span class="dt">sd=</span><span class="dv">1</span>), <span class="dt">ncol=</span><span class="dv">2</span>)</span>
<span id="cb24-28"><a href="#cb24-28"></a>  y1 &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">rnorm</span>(<span class="dv">100</span>,<span class="dt">mean=</span><span class="fl">0.5</span>,<span class="dt">sd=</span><span class="fl">1.5</span>),<span class="dt">ncol=</span><span class="dv">2</span>)</span>
<span id="cb24-29"><a href="#cb24-29"></a>  z1 &lt;-<span class="st"> </span><span class="kw">rbind</span>(x1, y1)</span>
<span id="cb24-30"><a href="#cb24-30"></a>  p1[i,<span class="dv">1</span>]&lt;-<span class="kw">eqdist.nn</span>(z1,N,k)<span class="op">$</span>p.value</span>
<span id="cb24-31"><a href="#cb24-31"></a>  p1[i,<span class="dv">2</span>]&lt;-<span class="kw">eqdist.etest</span>(z1,<span class="dt">sizes=</span>N,<span class="dt">R=</span>R)<span class="op">$</span>p.value</span>
<span id="cb24-32"><a href="#cb24-32"></a>  p1[i,<span class="dv">3</span>]&lt;-<span class="kw">bd.test</span>(<span class="dt">x=</span>x1,<span class="dt">y=</span>y1,<span class="dt">R=</span><span class="dv">99</span>,<span class="dt">seed=</span>i<span class="op">*</span><span class="dv">12345</span>)<span class="op">$</span>p.value</span>
<span id="cb24-33"><a href="#cb24-33"></a>}</span>
<span id="cb24-34"><a href="#cb24-34"></a>pow1 &lt;-<span class="st"> </span><span class="kw">colMeans</span>(p1<span class="op">&lt;</span><span class="fl">0.1</span>)</span>
<span id="cb24-35"><a href="#cb24-35"></a>pow1</span>
<span id="cb24-36"><a href="#cb24-36"></a><span class="co">#&gt; [1] 0.434 0.577 0.935</span></span></code></pre></div>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1"></a><span class="co">#Unequal variances and unequal expectations</span></span>
<span id="cb25-2"><a href="#cb25-2"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){</span>
<span id="cb25-3"><a href="#cb25-3"></a>  x2 &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">rnorm</span>(<span class="dv">100</span>,<span class="dt">mean=</span><span class="fl">0.5</span>,<span class="dt">sd=</span><span class="fl">1.2</span>), <span class="dt">ncol=</span><span class="dv">2</span>)</span>
<span id="cb25-4"><a href="#cb25-4"></a>  y2 &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">rnorm</span>(<span class="dv">100</span>,<span class="dt">mean=</span><span class="dv">1</span>,<span class="dt">sd=</span><span class="fl">1.5</span>),<span class="dt">ncol=</span><span class="dv">2</span>)</span>
<span id="cb25-5"><a href="#cb25-5"></a>  z2 &lt;-<span class="st"> </span><span class="kw">rbind</span>(x2, y2)</span>
<span id="cb25-6"><a href="#cb25-6"></a>  p2[i,<span class="dv">1</span>]&lt;-<span class="kw">eqdist.nn</span>(z2,N,k)<span class="op">$</span>p.value</span>
<span id="cb25-7"><a href="#cb25-7"></a>  p2[i,<span class="dv">2</span>]&lt;-<span class="kw">eqdist.etest</span>(z2,<span class="dt">sizes=</span>N,<span class="dt">R=</span>R)<span class="op">$</span>p.value</span>
<span id="cb25-8"><a href="#cb25-8"></a>  p2[i,<span class="dv">3</span>]&lt;-<span class="kw">bd.test</span>(<span class="dt">x=</span>x2,<span class="dt">y=</span>y2,<span class="dt">R=</span><span class="dv">99</span>,<span class="dt">seed=</span>i<span class="op">*</span><span class="dv">12345</span>)<span class="op">$</span>p.value</span>
<span id="cb25-9"><a href="#cb25-9"></a>}</span>
<span id="cb25-10"><a href="#cb25-10"></a>pow2 &lt;-<span class="st"> </span><span class="kw">colMeans</span>(p2<span class="op">&lt;</span><span class="fl">0.1</span>)</span>
<span id="cb25-11"><a href="#cb25-11"></a>pow2</span>
<span id="cb25-12"><a href="#cb25-12"></a><span class="co">#&gt; [1] 0.388 0.799 0.839</span></span></code></pre></div>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1"></a><span class="co">#Non-normal distributions: t distribution with 1 df，bimodel distribution</span></span>
<span id="cb26-2"><a href="#cb26-2"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){</span>
<span id="cb26-3"><a href="#cb26-3"></a>  x3 &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">rt</span>(<span class="dv">100</span>,<span class="dt">df=</span><span class="dv">1</span>), <span class="dt">ncol=</span><span class="dv">2</span>)</span>
<span id="cb26-4"><a href="#cb26-4"></a>  y&lt;-<span class="kw">numeric</span>()</span>
<span id="cb26-5"><a href="#cb26-5"></a>  <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">100</span>){</span>
<span id="cb26-6"><a href="#cb26-6"></a>      r&lt;-<span class="kw">sample</span>(<span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),<span class="dv">1</span>,<span class="dt">replace=</span><span class="ot">TRUE</span>,<span class="dt">prob=</span><span class="kw">c</span>(<span class="fl">0.3</span>,<span class="fl">0.7</span>))</span>
<span id="cb26-7"><a href="#cb26-7"></a>      y[j]&lt;-<span class="kw">ifelse</span>(r<span class="op">==</span><span class="dv">0</span>,<span class="kw">rnorm</span>(<span class="dv">1</span>,<span class="fl">0.5</span>,<span class="dv">2</span>),<span class="kw">rnorm</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">3</span>))</span>
<span id="cb26-8"><a href="#cb26-8"></a>  }</span>
<span id="cb26-9"><a href="#cb26-9"></a>  y3&lt;-<span class="kw">matrix</span>(y,<span class="dt">ncol=</span><span class="dv">2</span>)</span>
<span id="cb26-10"><a href="#cb26-10"></a>  z3 &lt;-<span class="st"> </span><span class="kw">rbind</span>(x3, y3)</span>
<span id="cb26-11"><a href="#cb26-11"></a>  p3[i,<span class="dv">1</span>]&lt;-<span class="kw">eqdist.nn</span>(z3,N,k)<span class="op">$</span>p.value</span>
<span id="cb26-12"><a href="#cb26-12"></a>  p3[i,<span class="dv">2</span>]&lt;-<span class="kw">eqdist.etest</span>(z3,<span class="dt">sizes=</span>N,<span class="dt">R=</span>R)<span class="op">$</span>p.value</span>
<span id="cb26-13"><a href="#cb26-13"></a>  p3[i,<span class="dv">3</span>]&lt;-<span class="kw">bd.test</span>(<span class="dt">x=</span>x3,<span class="dt">y=</span>y3,<span class="dt">R=</span><span class="dv">99</span>,<span class="dt">seed=</span>i<span class="op">*</span><span class="dv">12345</span>)<span class="op">$</span>p.value</span>
<span id="cb26-14"><a href="#cb26-14"></a>}</span>
<span id="cb26-15"><a href="#cb26-15"></a>pow3 &lt;-<span class="st"> </span><span class="kw">colMeans</span>(p3<span class="op">&lt;</span><span class="fl">0.1</span>)</span>
<span id="cb26-16"><a href="#cb26-16"></a>pow3</span>
<span id="cb26-17"><a href="#cb26-17"></a><span class="co">#&gt; [1] 0.743 0.847 0.827</span></span></code></pre></div>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1"></a><span class="co">#t distribution </span></span>
<span id="cb27-2"><a href="#cb27-2"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){</span>
<span id="cb27-3"><a href="#cb27-3"></a>  x4 &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">rt</span>(<span class="dv">100</span>,<span class="dt">df=</span><span class="dv">1</span>), <span class="dt">ncol=</span><span class="dv">2</span>)</span>
<span id="cb27-4"><a href="#cb27-4"></a>  y4&lt;-<span class="kw">matrix</span>(<span class="kw">rt</span>(<span class="dv">100</span>,<span class="dt">df=</span><span class="dv">5</span>),<span class="dt">ncol=</span><span class="dv">2</span>)</span>
<span id="cb27-5"><a href="#cb27-5"></a>  z4 &lt;-<span class="st"> </span><span class="kw">rbind</span>(x4, y4)</span>
<span id="cb27-6"><a href="#cb27-6"></a>  p4[i,<span class="dv">1</span>]&lt;-<span class="kw">eqdist.nn</span>(z4,N,k)<span class="op">$</span>p.value</span>
<span id="cb27-7"><a href="#cb27-7"></a>  p4[i,<span class="dv">2</span>]&lt;-<span class="kw">eqdist.etest</span>(z4,<span class="dt">sizes=</span>N,<span class="dt">R=</span>R)<span class="op">$</span>p.value</span>
<span id="cb27-8"><a href="#cb27-8"></a>  p4[i,<span class="dv">3</span>]&lt;-<span class="kw">bd.test</span>(<span class="dt">x=</span>x4,<span class="dt">y=</span>y4,<span class="dt">R=</span><span class="dv">99</span>,<span class="dt">seed=</span>i<span class="op">*</span><span class="dv">12345</span>)<span class="op">$</span>p.value</span>
<span id="cb27-9"><a href="#cb27-9"></a>}</span>
<span id="cb27-10"><a href="#cb27-10"></a>pow4 &lt;-<span class="st"> </span><span class="kw">colMeans</span>(p4<span class="op">&lt;</span><span class="fl">0.1</span>)</span>
<span id="cb27-11"><a href="#cb27-11"></a>pow4</span>
<span id="cb27-12"><a href="#cb27-12"></a><span class="co">#&gt; [1] 0.597 0.981 0.990</span></span></code></pre></div>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1"></a><span class="co">#unbalanced samples</span></span>
<span id="cb28-2"><a href="#cb28-2"></a>n3&lt;-<span class="dv">25</span>;n4&lt;-<span class="dv">250</span>;n5 &lt;-<span class="st"> </span>n3<span class="op">+</span>n4;N1&lt;-<span class="kw">c</span>(n3,n4)</span>
<span id="cb28-3"><a href="#cb28-3"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){</span>
<span id="cb28-4"><a href="#cb28-4"></a>  x6 &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">rnorm</span>(<span class="dv">50</span>,<span class="dt">mean=</span><span class="fl">0.5</span>,<span class="dt">sd=</span><span class="dv">1</span>), <span class="dt">ncol=</span><span class="dv">2</span>)</span>
<span id="cb28-5"><a href="#cb28-5"></a>  y6 &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">rnorm</span>(<span class="dv">500</span>,<span class="dt">mean=</span><span class="fl">0.5</span>,<span class="dt">sd=</span><span class="fl">1.5</span>),<span class="dt">ncol=</span><span class="dv">2</span>)</span>
<span id="cb28-6"><a href="#cb28-6"></a>  z6 &lt;-<span class="st"> </span><span class="kw">rbind</span>(x6, y6)</span>
<span id="cb28-7"><a href="#cb28-7"></a>  p6[i,<span class="dv">1</span>]&lt;-<span class="kw">eqdist.nn</span>(z6,N1,k)<span class="op">$</span>p.value</span>
<span id="cb28-8"><a href="#cb28-8"></a>  p6[i,<span class="dv">2</span>]&lt;-<span class="kw">eqdist.etest</span>(z6,<span class="dt">sizes=</span>N1,<span class="dt">R=</span>R)<span class="op">$</span>p.value</span>
<span id="cb28-9"><a href="#cb28-9"></a>  p6[i,<span class="dv">3</span>]&lt;-<span class="kw">bd.test</span>(<span class="dt">x=</span>x6,<span class="dt">y=</span>y6,<span class="dt">R=</span><span class="dv">99</span>,<span class="dt">seed=</span>i<span class="op">*</span><span class="dv">12345</span>)<span class="op">$</span>p.value</span>
<span id="cb28-10"><a href="#cb28-10"></a>}</span>
<span id="cb28-11"><a href="#cb28-11"></a>pow6 &lt;-<span class="st"> </span><span class="kw">colMeans</span>(p6<span class="op">&lt;</span><span class="fl">0.1</span>)</span>
<span id="cb28-12"><a href="#cb28-12"></a>pow6</span>
<span id="cb28-13"><a href="#cb28-13"></a><span class="co">#&gt; [1] 0.159 0.237 0.918</span></span></code></pre></div>
</div>
<div id="hw7" class="section level2">
<h2>HW7</h2>
</div>
<div id="question-10" class="section level2">
<h2>Question</h2>
<p>9.4 Implement a random walk Metropolis sampler for generating the standard Laplace distribution (see Exercise 3.2). For the increment, simulate from a normal distribution. Compare the chains generated when different variances are used for the proposal distribution. Also, compute the acceptance rates of each chain.</p>
</div>
<div id="answer-10" class="section level2">
<h2>Answer</h2>
<p>The standard Laplace distribution has density<span class="math display">\[f(x)=\frac{1}{2}e^{-|x|},x\in R\]</span> so<span class="math display">\[r(x_t,y)=\frac{f(Y)}{f(X_t)}=\frac{e^{-|Y|}}{e^{-|X_t|}}=e^{|X_t|-|Y|}\]</span></p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1"></a>wl &lt;-<span class="st"> </span><span class="cf">function</span>(sigma, x0, N) {</span>
<span id="cb29-2"><a href="#cb29-2"></a> x &lt;-<span class="st"> </span><span class="kw">numeric</span>(N)</span>
<span id="cb29-3"><a href="#cb29-3"></a> x[<span class="dv">1</span>] &lt;-<span class="st"> </span>x0</span>
<span id="cb29-4"><a href="#cb29-4"></a> u &lt;-<span class="st"> </span><span class="kw">runif</span>(N)</span>
<span id="cb29-5"><a href="#cb29-5"></a> k &lt;-<span class="st"> </span><span class="dv">0</span></span>
<span id="cb29-6"><a href="#cb29-6"></a> <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="op">:</span>N) {</span>
<span id="cb29-7"><a href="#cb29-7"></a>    y &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">1</span>, x[i<span class="dv">-1</span>], sigma)</span>
<span id="cb29-8"><a href="#cb29-8"></a>    r&lt;-<span class="kw">exp</span>(<span class="kw">abs</span>(x[i<span class="dv">-1</span>])<span class="op">-</span><span class="kw">abs</span>(y))</span>
<span id="cb29-9"><a href="#cb29-9"></a>    <span class="cf">if</span> (u[i] <span class="op">&lt;=</span><span class="st"> </span>r)</span>
<span id="cb29-10"><a href="#cb29-10"></a>     x[i] &lt;-<span class="st"> </span>y <span class="cf">else</span> {</span>
<span id="cb29-11"><a href="#cb29-11"></a>      x[i] &lt;-<span class="st"> </span>x[i<span class="dv">-1</span>]</span>
<span id="cb29-12"><a href="#cb29-12"></a>      k &lt;-<span class="st"> </span>k <span class="op">+</span><span class="st"> </span><span class="dv">1</span></span>
<span id="cb29-13"><a href="#cb29-13"></a>  }</span>
<span id="cb29-14"><a href="#cb29-14"></a> }</span>
<span id="cb29-15"><a href="#cb29-15"></a>  <span class="kw">return</span>(<span class="kw">list</span>(<span class="dt">x=</span>x, <span class="dt">k=</span>k))</span>
<span id="cb29-16"><a href="#cb29-16"></a>}</span>
<span id="cb29-17"><a href="#cb29-17"></a></span>
<span id="cb29-18"><a href="#cb29-18"></a>N &lt;-<span class="st"> </span><span class="dv">1000</span></span>
<span id="cb29-19"><a href="#cb29-19"></a>sigma &lt;-<span class="st"> </span><span class="kw">c</span>(.<span class="dv">5</span>, <span class="dv">2</span>, <span class="dv">10</span>, <span class="dv">16</span>)</span>
<span id="cb29-20"><a href="#cb29-20"></a>x0 &lt;-<span class="st"> </span><span class="dv">10</span></span>
<span id="cb29-21"><a href="#cb29-21"></a>wl1 &lt;-<span class="st"> </span><span class="kw">wl</span>( sigma[<span class="dv">1</span>], x0, N)</span>
<span id="cb29-22"><a href="#cb29-22"></a>wl2 &lt;-<span class="st"> </span><span class="kw">wl</span>( sigma[<span class="dv">2</span>], x0, N)</span>
<span id="cb29-23"><a href="#cb29-23"></a>wl3 &lt;-<span class="st"> </span><span class="kw">wl</span>( sigma[<span class="dv">3</span>], x0, N)</span>
<span id="cb29-24"><a href="#cb29-24"></a>wl4 &lt;-<span class="st"> </span><span class="kw">wl</span>( sigma[<span class="dv">4</span>], x0, N)</span>
<span id="cb29-25"><a href="#cb29-25"></a><span class="co">#number of candidate points accepted</span></span>
<span id="cb29-26"><a href="#cb29-26"></a><span class="kw">print</span>(<span class="kw">c</span>(wl1<span class="op">$</span>k, wl2<span class="op">$</span>k, wl3<span class="op">$</span>k, wl4<span class="op">$</span>k))</span>
<span id="cb29-27"><a href="#cb29-27"></a><span class="co">#&gt; [1] 174 484 822 908</span></span>
<span id="cb29-28"><a href="#cb29-28"></a>accept&lt;-<span class="kw">c</span>((N<span class="dv">-1</span><span class="op">-</span>wl1<span class="op">$</span>k)<span class="op">/</span>N,(N<span class="dv">-1</span><span class="op">-</span>wl2<span class="op">$</span>k)<span class="op">/</span>N,(N<span class="dv">-1</span><span class="op">-</span>wl3<span class="op">$</span>k)<span class="op">/</span>N,(N<span class="dv">-1</span><span class="op">-</span>wl4<span class="op">$</span>k)<span class="op">/</span>N)</span>
<span id="cb29-29"><a href="#cb29-29"></a>m&lt;-<span class="kw">matrix</span>(<span class="kw">c</span>(sigma,accept),<span class="dt">ncol=</span><span class="dv">2</span>,<span class="dt">dimnames=</span><span class="kw">list</span>(<span class="kw">c</span>(<span class="st">&quot;wl1&quot;</span>,<span class="st">&quot;wl2&quot;</span>,<span class="st">&quot;wl3&quot;</span>,<span class="st">&quot;wl4&quot;</span>),<span class="kw">c</span>(<span class="st">&quot;variance&quot;</span>,<span class="st">&quot;acceptance rate&quot;</span>)))</span>
<span id="cb29-30"><a href="#cb29-30"></a>m</span>
<span id="cb29-31"><a href="#cb29-31"></a><span class="co">#&gt;     variance acceptance rate</span></span>
<span id="cb29-32"><a href="#cb29-32"></a><span class="co">#&gt; wl1      0.5           0.825</span></span>
<span id="cb29-33"><a href="#cb29-33"></a><span class="co">#&gt; wl2      2.0           0.515</span></span>
<span id="cb29-34"><a href="#cb29-34"></a><span class="co">#&gt; wl3     10.0           0.177</span></span>
<span id="cb29-35"><a href="#cb29-35"></a><span class="co">#&gt; wl4     16.0           0.091</span></span></code></pre></div>
<p>From the results, the first and second chain has a rejection rate in the range <span class="math inline">\([0.15,0.5]\)</span>,and the acceptance rate of the first chain is 0.828</p>
</div>
<div id="question-11" class="section level2">
<h2>Question</h2>
<p>For Exercise 9.4, use the Gelman-Rubin method to monitor convergence of the chain, and run the chain until it converges approximately to the target distribution according to <span class="math inline">\(\hat{R}&lt;1.2.\)</span></p>
</div>
<div id="answer-11" class="section level2">
<h2>Answer</h2>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1"></a>Gelman.Rubin &lt;-<span class="st"> </span><span class="cf">function</span>(psi) {</span>
<span id="cb30-2"><a href="#cb30-2"></a><span class="co"># psi[i,j] is the statistic psi(X[i,1:j])</span></span>
<span id="cb30-3"><a href="#cb30-3"></a><span class="co"># for chain in i-th row of X</span></span>
<span id="cb30-4"><a href="#cb30-4"></a>psi &lt;-<span class="st"> </span><span class="kw">as.matrix</span>(psi)</span>
<span id="cb30-5"><a href="#cb30-5"></a>n &lt;-<span class="st"> </span><span class="kw">ncol</span>(psi)</span>
<span id="cb30-6"><a href="#cb30-6"></a>k &lt;-<span class="st"> </span><span class="kw">nrow</span>(psi)</span>
<span id="cb30-7"><a href="#cb30-7"></a>psi.means &lt;-<span class="st"> </span><span class="kw">rowMeans</span>(psi) <span class="co">#row means</span></span>
<span id="cb30-8"><a href="#cb30-8"></a>B &lt;-<span class="st"> </span>n <span class="op">*</span><span class="st"> </span><span class="kw">var</span>(psi.means) <span class="co">#between variance est.</span></span>
<span id="cb30-9"><a href="#cb30-9"></a>psi.w &lt;-<span class="st"> </span><span class="kw">apply</span>(psi, <span class="dv">1</span>, <span class="st">&quot;var&quot;</span>) <span class="co">#within variances</span></span>
<span id="cb30-10"><a href="#cb30-10"></a>W &lt;-<span class="st"> </span><span class="kw">mean</span>(psi.w) <span class="co">#within est.</span></span>
<span id="cb30-11"><a href="#cb30-11"></a>v.hat &lt;-<span class="st"> </span>W<span class="op">*</span>(n<span class="dv">-1</span>)<span class="op">/</span>n <span class="op">+</span><span class="st"> </span>(B<span class="op">/</span>n) <span class="co">#upper variance est.</span></span>
<span id="cb30-12"><a href="#cb30-12"></a>r.hat &lt;-<span class="st"> </span>v.hat <span class="op">/</span><span class="st"> </span>W <span class="co">#G-R statistic</span></span>
<span id="cb30-13"><a href="#cb30-13"></a><span class="kw">return</span>(r.hat)</span>
<span id="cb30-14"><a href="#cb30-14"></a>}</span>
<span id="cb30-15"><a href="#cb30-15"></a></span>
<span id="cb30-16"><a href="#cb30-16"></a>LA.chain &lt;-<span class="st"> </span><span class="cf">function</span>(sigma, N, X1) {</span>
<span id="cb30-17"><a href="#cb30-17"></a><span class="co">#generates a Metropolis chain for standard Laplace distribution</span></span>
<span id="cb30-18"><a href="#cb30-18"></a><span class="co">#with Normal(X[t], sigma) proposal distribution</span></span>
<span id="cb30-19"><a href="#cb30-19"></a><span class="co">#and starting value X1</span></span>
<span id="cb30-20"><a href="#cb30-20"></a>  x &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="dv">0</span>, N)</span>
<span id="cb30-21"><a href="#cb30-21"></a>  x[<span class="dv">1</span>] &lt;-<span class="st"> </span>X1</span>
<span id="cb30-22"><a href="#cb30-22"></a>  u &lt;-<span class="st"> </span><span class="kw">runif</span>(N)</span>
<span id="cb30-23"><a href="#cb30-23"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="op">:</span>N) {</span>
<span id="cb30-24"><a href="#cb30-24"></a>     xt &lt;-<span class="st"> </span>x[i<span class="dv">-1</span>]</span>
<span id="cb30-25"><a href="#cb30-25"></a>     y &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">1</span>, xt, sigma) <span class="co">#candidate point</span></span>
<span id="cb30-26"><a href="#cb30-26"></a>     r1 &lt;-<span class="st"> </span><span class="kw">exp</span>(<span class="op">-</span><span class="kw">abs</span>(y)) <span class="op">*</span><span class="st"> </span><span class="kw">dnorm</span>(xt, y, sigma)<span class="op">/</span><span class="dv">2</span></span>
<span id="cb30-27"><a href="#cb30-27"></a>     r2 &lt;-<span class="st"> </span><span class="kw">exp</span>(<span class="op">-</span><span class="kw">abs</span>(xt)) <span class="op">*</span><span class="st"> </span><span class="kw">dnorm</span>(y, xt, sigma)<span class="op">/</span><span class="dv">2</span></span>
<span id="cb30-28"><a href="#cb30-28"></a>     r &lt;-<span class="st"> </span>r1 <span class="op">/</span><span class="st"> </span>r2</span>
<span id="cb30-29"><a href="#cb30-29"></a>     <span class="cf">if</span> (u[i] <span class="op">&lt;=</span><span class="st"> </span>r) x[i] &lt;-<span class="st"> </span>y <span class="cf">else</span></span>
<span id="cb30-30"><a href="#cb30-30"></a>     x[i] &lt;-<span class="st"> </span>xt</span>
<span id="cb30-31"><a href="#cb30-31"></a>}</span>
<span id="cb30-32"><a href="#cb30-32"></a><span class="kw">return</span>(x)</span>
<span id="cb30-33"><a href="#cb30-33"></a>}</span>
<span id="cb30-34"><a href="#cb30-34"></a></span>
<span id="cb30-35"><a href="#cb30-35"></a>sigma &lt;-<span class="st"> </span><span class="dv">5</span> <span class="co">#parameter of proposal distribution</span></span>
<span id="cb30-36"><a href="#cb30-36"></a>k &lt;-<span class="st"> </span><span class="dv">4</span> <span class="co">#number of chains to generate</span></span>
<span id="cb30-37"><a href="#cb30-37"></a>n &lt;-<span class="st"> </span><span class="dv">15000</span> <span class="co">#length of chains</span></span>
<span id="cb30-38"><a href="#cb30-38"></a>b &lt;-<span class="st"> </span><span class="dv">1000</span> <span class="co">#burn-in length</span></span>
<span id="cb30-39"><a href="#cb30-39"></a><span class="co">#choose overdispersed initial values</span></span>
<span id="cb30-40"><a href="#cb30-40"></a>x0 &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="op">-</span><span class="dv">10</span>, <span class="dv">-5</span>, <span class="dv">5</span>, <span class="dv">10</span>)</span>
<span id="cb30-41"><a href="#cb30-41"></a><span class="co">#generate the chains</span></span>
<span id="cb30-42"><a href="#cb30-42"></a>X &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">0</span>, <span class="dt">nrow=</span>k, <span class="dt">ncol=</span>n)</span>
<span id="cb30-43"><a href="#cb30-43"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>k)</span>
<span id="cb30-44"><a href="#cb30-44"></a>X[i, ] &lt;-<span class="st"> </span><span class="kw">LA.chain</span>(sigma, n, x0[i])</span>
<span id="cb30-45"><a href="#cb30-45"></a></span>
<span id="cb30-46"><a href="#cb30-46"></a><span class="co">#compute diagnostic statistics</span></span>
<span id="cb30-47"><a href="#cb30-47"></a>psi &lt;-<span class="st"> </span><span class="kw">t</span>(<span class="kw">apply</span>(X, <span class="dv">1</span>, cumsum))</span>
<span id="cb30-48"><a href="#cb30-48"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(psi))</span>
<span id="cb30-49"><a href="#cb30-49"></a>psi[i,] &lt;-<span class="st"> </span>psi[i,] <span class="op">/</span><span class="st"> </span>(<span class="dv">1</span><span class="op">:</span><span class="kw">ncol</span>(psi))</span>
<span id="cb30-50"><a href="#cb30-50"></a><span class="kw">print</span>(<span class="kw">Gelman.Rubin</span>(psi))</span>
<span id="cb30-51"><a href="#cb30-51"></a><span class="co">#&gt; [1] 1.274353</span></span></code></pre></div>
</div>
<div id="question-12" class="section level2">
<h2>Question</h2>
<p>11.4 Find the intersection points <span class="math inline">\(A(k)\)</span> in <span class="math inline">\((0,\sqrt{k})\)</span> of the curves <span class="math display">\[S_{k-1}(a)=P(t(k-1)&gt;\sqrt{\frac{a^2(k-1)}{k-a^2}})\]</span> and <span class="math display">\[S_{k}(a)=P(t(k)&gt;\sqrt{\frac{a^2k}{k+1-a^2}}),\]</span> for <span class="math inline">\(k=4:25,100,500,1000,\)</span> where <span class="math inline">\(t(k)\)</span> is a Student <span class="math inline">\(t\)</span> random variable with k degrees of freedom. (These intersection points determine the critical values for a t-test for scale-mixture errors proposed by Sz´ekely [260].)</p>
</div>
<div id="answer-12" class="section level2">
<h2>Answer</h2>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1"></a>root=<span class="cf">function</span>(k){</span>
<span id="cb31-2"><a href="#cb31-2"></a>s1=<span class="cf">function</span>(a){</span>
<span id="cb31-3"><a href="#cb31-3"></a>  <span class="dv">1</span><span class="op">-</span><span class="kw">pt</span>(<span class="kw">sqrt</span>((k<span class="dv">-1</span>)<span class="op">*</span>a<span class="op">^</span><span class="dv">2</span><span class="op">/</span>(k<span class="op">-</span>a<span class="op">^</span><span class="dv">2</span>)),k<span class="dv">-1</span>)</span>
<span id="cb31-4"><a href="#cb31-4"></a>}</span>
<span id="cb31-5"><a href="#cb31-5"></a>s2=<span class="cf">function</span>(a){</span>
<span id="cb31-6"><a href="#cb31-6"></a>  <span class="dv">1</span><span class="op">-</span><span class="kw">pt</span>(<span class="kw">sqrt</span>(k<span class="op">*</span>a<span class="op">^</span><span class="dv">2</span><span class="op">/</span>(k<span class="op">+</span><span class="dv">1</span><span class="op">-</span>a<span class="op">^</span><span class="dv">2</span>)),k)</span>
<span id="cb31-7"><a href="#cb31-7"></a>}</span>
<span id="cb31-8"><a href="#cb31-8"></a>f&lt;-<span class="cf">function</span>(a){</span>
<span id="cb31-9"><a href="#cb31-9"></a>  <span class="kw">s1</span>(a)<span class="op">-</span><span class="kw">s2</span>(a)</span>
<span id="cb31-10"><a href="#cb31-10"></a>}</span>
<span id="cb31-11"><a href="#cb31-11"></a><span class="kw">return</span>(<span class="kw">uniroot</span>(f,<span class="dt">interval =</span> <span class="kw">c</span>(<span class="fl">1e-6</span>,<span class="kw">sqrt</span>(k)<span class="op">-</span><span class="fl">1e-6</span>))<span class="op">$</span>root)</span>
<span id="cb31-12"><a href="#cb31-12"></a>}</span>
<span id="cb31-13"><a href="#cb31-13"></a>r =<span class="st"> </span><span class="kw">sapply</span>(<span class="kw">c</span>(<span class="dv">4</span><span class="op">:</span><span class="dv">25</span>, <span class="dv">100</span>, <span class="dv">500</span>, <span class="dv">1000</span>), <span class="cf">function</span> (k) {</span>
<span id="cb31-14"><a href="#cb31-14"></a>  <span class="kw">root</span>(k)</span>
<span id="cb31-15"><a href="#cb31-15"></a>  })</span>
<span id="cb31-16"><a href="#cb31-16"></a>r</span>
<span id="cb31-17"><a href="#cb31-17"></a><span class="co">#&gt;  [1]  1.492103  1.533549  1.562768  1.584421  1.601182  1.614517  1.625406</span></span>
<span id="cb31-18"><a href="#cb31-18"></a><span class="co">#&gt;  [8]  1.634409  1.642026  1.648511  1.654174  1.659121  1.663442  1.667288</span></span>
<span id="cb31-19"><a href="#cb31-19"></a><span class="co">#&gt; [15]  1.670736  1.673841  1.676589  1.679139  1.681461  4.795831  4.898978</span></span>
<span id="cb31-20"><a href="#cb31-20"></a><span class="co">#&gt; [22]  4.999999  9.999999 22.360679 31.622776</span></span></code></pre></div>
</div>
<div id="hw8" class="section level2">
<h2>HW8</h2>
</div>
<div id="question-13" class="section level2">
<h2>Question</h2>
<ul>
<li><p>A-B-O blood type problem</p></li>
<li><p>Let the three alleles be A, B, and O.</p></li>
</ul>
<table>
<thead>
<tr class="header">
<th align="left">Genotype</th>
<th align="left">AA</th>
<th align="left">BB</th>
<th align="left">OO</th>
<th align="left">AO</th>
<th align="left">BO</th>
<th align="left">AB</th>
<th align="left">Sum</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Frequency</td>
<td align="left">p^2</td>
<td align="left">q^2</td>
<td align="left">r^2</td>
<td align="left">2pr</td>
<td align="left">2qr</td>
<td align="left">2pq</td>
<td align="left">1</td>
</tr>
<tr class="even">
<td align="left">Count</td>
<td align="left">nAA</td>
<td align="left">nBB</td>
<td align="left">nOO</td>
<td align="left">nAO</td>
<td align="left">nBO</td>
<td align="left">nAB</td>
<td align="left">n</td>
</tr>
</tbody>
</table>
<ul>
<li><p>Observed data: <span class="math inline">\(n_{A·}=n_{AA}+n_{AO}=444(A-type),n_{B·}=n_{BB}+n_{BO}=132 (B-type),n_{OO}=361(O-type),n_{AB}=63(AB-type)\)</span></p></li>
<li><p>Use EM algorithm to solve MLE of <span class="math inline">\(p\)</span> and <span class="math inline">\(q\)</span> (consider missing data <span class="math inline">\(n_{AA}\)</span> and <span class="math inline">\(n_{BB}\)</span>).</p></li>
<li><p>Record the values of p and q that maximize the conditional likelihood in each EM steps, calculate the corresponding log-maximum likelihood values (for observed data), are they increasing?</p></li>
</ul>
</div>
<div id="answer-13" class="section level2">
<h2>Answer</h2>
<div id="observed-data-likelihood" class="section level5">
<h5>Observed data likelihood</h5>
<p><span class="math display">\[L(p,q|n_{OO},n_{AB},n_{A·},n_{B·})=(p^2+2pr)^{n_{A·}}(q^2+2qr)^{n_{B·}}(r^2)^{n_{OO}}(2pq)^{n_{AB}}\]</span></p>
</div>
<div id="complete-data-likelihood" class="section level4">
<h4>Complete data likelihood</h4>
<p><span class="math display">\[L=\frac{n!}{n_{OO}!n_{AB}!n_{AA}!n_{AO}!n_{BB}!n_{BO}!}(r^2)^{n_{OO}}(2pq)^{n_{AB}}(p^2)^{n_{AA}}(2pr)^{n_{AO}}(q^2)^{n_{BB}}(2qr)^{n_{BO}}\]</span> <span class="math display">\[\log L=2n_{OO}\log r+n_{AB}log(2pq)+(2n_{A·}-n_{AO})\log p +(2n_{B·}-n_{BO})log q+(n_{AO}+n_{BO})log(2r)+log\frac{n!}{n_{OO}!n_{AB}!n_{AA}!n_{AO}!n_{BB}!n_{BO}!},where\]</span> <span class="math display">\[ n_{AO}\sim B(n_{A·},\frac{2r}{p+2r}),n_{BO}\sim B(n_{B·},\frac{2r}{q+2r})\]</span></p>
<p><span class="math display">\[Q(p,q|p^{(t)},q^{(t)})=E(\log L|n_{OO},n_{AB},n_{AO},n_{BO},n_{AA},n_{BB})=2n_{OO}\log r+n_{AB}log(2pq)+(2n_{A·}-\hat{n}_{AO}^{(t)})\log p +(2n_{B·}-\hat{n}_{BO}^{(t)})log q+(\hat{n}_{AO}^{(t)}+\hat{n}_{BO}^{(t)})log(2r)+c\]</span> <span class="math display">\[\hat{n}_{AO}^{(t)}=\frac{2r}{p+2r},\hat{n}_{BO}^{(t)}=\frac{2r}{q+2r}\]</span></p>
<p><span class="math display">\[p^{(t+1)}=\frac{n_{AB}+2n_{A·}-n_{AO}}{2n}\]</span> <span class="math display">\[q^{(t+1)}=\frac{n_{AB}+2n_{B·}-n_{BO}}{2n}\]</span></p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1"></a></span>
<span id="cb32-2"><a href="#cb32-2"></a>na&lt;-<span class="dv">444</span></span>
<span id="cb32-3"><a href="#cb32-3"></a>nb&lt;-<span class="dv">132</span></span>
<span id="cb32-4"><a href="#cb32-4"></a>noo&lt;-<span class="dv">361</span></span>
<span id="cb32-5"><a href="#cb32-5"></a>nab&lt;-<span class="dv">63</span></span>
<span id="cb32-6"><a href="#cb32-6"></a>n&lt;-na<span class="op">+</span>nb<span class="op">+</span>nab<span class="op">+</span>noo</span>
<span id="cb32-7"><a href="#cb32-7"></a>lg&lt;-<span class="kw">numeric</span>(<span class="dv">11</span>)</span>
<span id="cb32-8"><a href="#cb32-8"></a>p&lt;-<span class="fl">0.6</span></span>
<span id="cb32-9"><a href="#cb32-9"></a>q&lt;-<span class="fl">0.3</span><span class="co">#设置初始值</span></span>
<span id="cb32-10"><a href="#cb32-10"></a>   <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">15</span>){</span>
<span id="cb32-11"><a href="#cb32-11"></a>   nao&lt;-na<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>p<span class="op">/</span>(<span class="dv">2</span><span class="op">-</span>p<span class="dv">-2</span><span class="op">*</span>q))</span>
<span id="cb32-12"><a href="#cb32-12"></a>   nbo&lt;-nb<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>q<span class="op">/</span>(<span class="dv">2-2</span><span class="op">*</span>p<span class="op">-</span>q))</span>
<span id="cb32-13"><a href="#cb32-13"></a>   lg[i]&lt;-na<span class="op">*</span><span class="kw">log</span>(p<span class="op">^</span><span class="dv">2</span><span class="op">+</span><span class="dv">2</span><span class="op">*</span>p<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>p<span class="op">-</span>q))<span class="op">+</span>nb<span class="op">*</span><span class="kw">log</span>(q<span class="op">^</span><span class="dv">2</span><span class="op">+</span><span class="dv">2</span><span class="op">*</span>q<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>p<span class="op">-</span>q))<span class="op">+</span>noo<span class="op">*</span><span class="kw">log</span>((<span class="dv">1</span><span class="op">-</span>p<span class="op">-</span>q)<span class="op">^</span><span class="dv">2</span>)<span class="op">+</span>nab<span class="op">*</span><span class="kw">log</span>(<span class="dv">2</span><span class="op">*</span>p<span class="op">*</span>q)<span class="co">#the corresponding log-maximum likelihood values (for observed data)</span></span>
<span id="cb32-14"><a href="#cb32-14"></a>   p&lt;-(nab<span class="op">+</span><span class="dv">2</span><span class="op">*</span>na<span class="op">-</span>nao)<span class="op">/</span>(<span class="dv">2</span><span class="op">*</span>n)</span>
<span id="cb32-15"><a href="#cb32-15"></a>   q&lt;-(nab<span class="op">+</span><span class="dv">2</span><span class="op">*</span>nb<span class="op">-</span>nbo)<span class="op">/</span>(<span class="dv">2</span><span class="op">*</span>n)</span>
<span id="cb32-16"><a href="#cb32-16"></a>   }</span>
<span id="cb32-17"><a href="#cb32-17"></a><span class="kw">cat</span>(<span class="st">&quot;p=&quot;</span>,p,<span class="st">&quot;</span><span class="ch">\n</span><span class="st">q=&quot;</span>,q,<span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span>)</span>
<span id="cb32-18"><a href="#cb32-18"></a><span class="co">#&gt; p= 0.2976407 </span></span>
<span id="cb32-19"><a href="#cb32-19"></a><span class="co">#&gt; q= 0.1027063</span></span>
<span id="cb32-20"><a href="#cb32-20"></a><span class="kw">print</span>(lg)</span>
<span id="cb32-21"><a href="#cb32-21"></a><span class="co">#&gt;  [1] -2303.133 -1250.178 -1173.196 -1169.939 -1169.826 -1169.822 -1169.822</span></span>
<span id="cb32-22"><a href="#cb32-22"></a><span class="co">#&gt;  [8] -1169.822 -1169.822 -1169.822 -1169.822 -1169.822 -1169.822 -1169.822</span></span>
<span id="cb32-23"><a href="#cb32-23"></a><span class="co">#&gt; [15] -1169.822</span></span></code></pre></div>
</div>
</div>
<div id="question-14" class="section level2">
<h2>QUestion</h2>
<p>Exercises 3 (page 204, Advanced R)</p>
<p>Use both for loops and lapply() to fit linear models to the mtcars using the formulas stored in this list:</p>
<pre><code>   formulas &lt;- list(
   mpg ~ disp,
   mpg ~ I(1 / disp),
   mpg ~ disp + wt,
   mpg ~ I(1 / disp) + wt
   )</code></pre>
</div>
<div id="answer-14" class="section level2">
<h2>Answer</h2>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1"></a> formulas &lt;-<span class="st"> </span><span class="kw">list</span>(</span>
<span id="cb34-2"><a href="#cb34-2"></a>       mpg <span class="op">~</span><span class="st"> </span>disp,</span>
<span id="cb34-3"><a href="#cb34-3"></a>       mpg <span class="op">~</span><span class="st"> </span><span class="kw">I</span>(<span class="dv">1</span> <span class="op">/</span><span class="st"> </span>disp),</span>
<span id="cb34-4"><a href="#cb34-4"></a>       mpg <span class="op">~</span><span class="st"> </span>disp <span class="op">+</span><span class="st"> </span>wt,</span>
<span id="cb34-5"><a href="#cb34-5"></a>       mpg <span class="op">~</span><span class="st"> </span><span class="kw">I</span>(<span class="dv">1</span> <span class="op">/</span><span class="st"> </span>disp) <span class="op">+</span><span class="st"> </span>wt</span>
<span id="cb34-6"><a href="#cb34-6"></a>       )</span>
<span id="cb34-7"><a href="#cb34-7"></a></span>
<span id="cb34-8"><a href="#cb34-8"></a><span class="co"># use for loops</span></span>
<span id="cb34-9"><a href="#cb34-9"></a>L &lt;-<span class="st"> </span><span class="kw">vector</span>(<span class="st">&quot;list&quot;</span>, <span class="kw">length</span>(formulas))</span>
<span id="cb34-10"><a href="#cb34-10"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="kw">seq_along</span>(formulas)) {</span>
<span id="cb34-11"><a href="#cb34-11"></a>  L[[i]] &lt;-<span class="st"> </span><span class="kw">lm</span>(formulas[[i]],<span class="dt">data=</span>mtcars)</span>
<span id="cb34-12"><a href="#cb34-12"></a>}</span>
<span id="cb34-13"><a href="#cb34-13"></a><span class="kw">print</span>(L)</span>
<span id="cb34-14"><a href="#cb34-14"></a><span class="co">#&gt; [[1]]</span></span>
<span id="cb34-15"><a href="#cb34-15"></a><span class="co">#&gt; </span></span>
<span id="cb34-16"><a href="#cb34-16"></a><span class="co">#&gt; Call:</span></span>
<span id="cb34-17"><a href="#cb34-17"></a><span class="co">#&gt; lm(formula = formulas[[i]], data = mtcars)</span></span>
<span id="cb34-18"><a href="#cb34-18"></a><span class="co">#&gt; </span></span>
<span id="cb34-19"><a href="#cb34-19"></a><span class="co">#&gt; Coefficients:</span></span>
<span id="cb34-20"><a href="#cb34-20"></a><span class="co">#&gt; (Intercept)         disp  </span></span>
<span id="cb34-21"><a href="#cb34-21"></a><span class="co">#&gt;    29.59985     -0.04122  </span></span>
<span id="cb34-22"><a href="#cb34-22"></a><span class="co">#&gt; </span></span>
<span id="cb34-23"><a href="#cb34-23"></a><span class="co">#&gt; </span></span>
<span id="cb34-24"><a href="#cb34-24"></a><span class="co">#&gt; [[2]]</span></span>
<span id="cb34-25"><a href="#cb34-25"></a><span class="co">#&gt; </span></span>
<span id="cb34-26"><a href="#cb34-26"></a><span class="co">#&gt; Call:</span></span>
<span id="cb34-27"><a href="#cb34-27"></a><span class="co">#&gt; lm(formula = formulas[[i]], data = mtcars)</span></span>
<span id="cb34-28"><a href="#cb34-28"></a><span class="co">#&gt; </span></span>
<span id="cb34-29"><a href="#cb34-29"></a><span class="co">#&gt; Coefficients:</span></span>
<span id="cb34-30"><a href="#cb34-30"></a><span class="co">#&gt; (Intercept)    I(1/disp)  </span></span>
<span id="cb34-31"><a href="#cb34-31"></a><span class="co">#&gt;       10.75      1557.67  </span></span>
<span id="cb34-32"><a href="#cb34-32"></a><span class="co">#&gt; </span></span>
<span id="cb34-33"><a href="#cb34-33"></a><span class="co">#&gt; </span></span>
<span id="cb34-34"><a href="#cb34-34"></a><span class="co">#&gt; [[3]]</span></span>
<span id="cb34-35"><a href="#cb34-35"></a><span class="co">#&gt; </span></span>
<span id="cb34-36"><a href="#cb34-36"></a><span class="co">#&gt; Call:</span></span>
<span id="cb34-37"><a href="#cb34-37"></a><span class="co">#&gt; lm(formula = formulas[[i]], data = mtcars)</span></span>
<span id="cb34-38"><a href="#cb34-38"></a><span class="co">#&gt; </span></span>
<span id="cb34-39"><a href="#cb34-39"></a><span class="co">#&gt; Coefficients:</span></span>
<span id="cb34-40"><a href="#cb34-40"></a><span class="co">#&gt; (Intercept)         disp           wt  </span></span>
<span id="cb34-41"><a href="#cb34-41"></a><span class="co">#&gt;    34.96055     -0.01772     -3.35083  </span></span>
<span id="cb34-42"><a href="#cb34-42"></a><span class="co">#&gt; </span></span>
<span id="cb34-43"><a href="#cb34-43"></a><span class="co">#&gt; </span></span>
<span id="cb34-44"><a href="#cb34-44"></a><span class="co">#&gt; [[4]]</span></span>
<span id="cb34-45"><a href="#cb34-45"></a><span class="co">#&gt; </span></span>
<span id="cb34-46"><a href="#cb34-46"></a><span class="co">#&gt; Call:</span></span>
<span id="cb34-47"><a href="#cb34-47"></a><span class="co">#&gt; lm(formula = formulas[[i]], data = mtcars)</span></span>
<span id="cb34-48"><a href="#cb34-48"></a><span class="co">#&gt; </span></span>
<span id="cb34-49"><a href="#cb34-49"></a><span class="co">#&gt; Coefficients:</span></span>
<span id="cb34-50"><a href="#cb34-50"></a><span class="co">#&gt; (Intercept)    I(1/disp)           wt  </span></span>
<span id="cb34-51"><a href="#cb34-51"></a><span class="co">#&gt;      19.024     1142.560       -1.798</span></span>
<span id="cb34-52"><a href="#cb34-52"></a></span>
<span id="cb34-53"><a href="#cb34-53"></a><span class="co">#use lapply()</span></span>
<span id="cb34-54"><a href="#cb34-54"></a><span class="kw">lapply</span>(formulas,lm,<span class="dt">data=</span>mtcars)</span>
<span id="cb34-55"><a href="#cb34-55"></a><span class="co">#&gt; [[1]]</span></span>
<span id="cb34-56"><a href="#cb34-56"></a><span class="co">#&gt; </span></span>
<span id="cb34-57"><a href="#cb34-57"></a><span class="co">#&gt; Call:</span></span>
<span id="cb34-58"><a href="#cb34-58"></a><span class="co">#&gt; FUN(formula = X[[i]], data = ..1)</span></span>
<span id="cb34-59"><a href="#cb34-59"></a><span class="co">#&gt; </span></span>
<span id="cb34-60"><a href="#cb34-60"></a><span class="co">#&gt; Coefficients:</span></span>
<span id="cb34-61"><a href="#cb34-61"></a><span class="co">#&gt; (Intercept)         disp  </span></span>
<span id="cb34-62"><a href="#cb34-62"></a><span class="co">#&gt;    29.59985     -0.04122  </span></span>
<span id="cb34-63"><a href="#cb34-63"></a><span class="co">#&gt; </span></span>
<span id="cb34-64"><a href="#cb34-64"></a><span class="co">#&gt; </span></span>
<span id="cb34-65"><a href="#cb34-65"></a><span class="co">#&gt; [[2]]</span></span>
<span id="cb34-66"><a href="#cb34-66"></a><span class="co">#&gt; </span></span>
<span id="cb34-67"><a href="#cb34-67"></a><span class="co">#&gt; Call:</span></span>
<span id="cb34-68"><a href="#cb34-68"></a><span class="co">#&gt; FUN(formula = X[[i]], data = ..1)</span></span>
<span id="cb34-69"><a href="#cb34-69"></a><span class="co">#&gt; </span></span>
<span id="cb34-70"><a href="#cb34-70"></a><span class="co">#&gt; Coefficients:</span></span>
<span id="cb34-71"><a href="#cb34-71"></a><span class="co">#&gt; (Intercept)    I(1/disp)  </span></span>
<span id="cb34-72"><a href="#cb34-72"></a><span class="co">#&gt;       10.75      1557.67  </span></span>
<span id="cb34-73"><a href="#cb34-73"></a><span class="co">#&gt; </span></span>
<span id="cb34-74"><a href="#cb34-74"></a><span class="co">#&gt; </span></span>
<span id="cb34-75"><a href="#cb34-75"></a><span class="co">#&gt; [[3]]</span></span>
<span id="cb34-76"><a href="#cb34-76"></a><span class="co">#&gt; </span></span>
<span id="cb34-77"><a href="#cb34-77"></a><span class="co">#&gt; Call:</span></span>
<span id="cb34-78"><a href="#cb34-78"></a><span class="co">#&gt; FUN(formula = X[[i]], data = ..1)</span></span>
<span id="cb34-79"><a href="#cb34-79"></a><span class="co">#&gt; </span></span>
<span id="cb34-80"><a href="#cb34-80"></a><span class="co">#&gt; Coefficients:</span></span>
<span id="cb34-81"><a href="#cb34-81"></a><span class="co">#&gt; (Intercept)         disp           wt  </span></span>
<span id="cb34-82"><a href="#cb34-82"></a><span class="co">#&gt;    34.96055     -0.01772     -3.35083  </span></span>
<span id="cb34-83"><a href="#cb34-83"></a><span class="co">#&gt; </span></span>
<span id="cb34-84"><a href="#cb34-84"></a><span class="co">#&gt; </span></span>
<span id="cb34-85"><a href="#cb34-85"></a><span class="co">#&gt; [[4]]</span></span>
<span id="cb34-86"><a href="#cb34-86"></a><span class="co">#&gt; </span></span>
<span id="cb34-87"><a href="#cb34-87"></a><span class="co">#&gt; Call:</span></span>
<span id="cb34-88"><a href="#cb34-88"></a><span class="co">#&gt; FUN(formula = X[[i]], data = ..1)</span></span>
<span id="cb34-89"><a href="#cb34-89"></a><span class="co">#&gt; </span></span>
<span id="cb34-90"><a href="#cb34-90"></a><span class="co">#&gt; Coefficients:</span></span>
<span id="cb34-91"><a href="#cb34-91"></a><span class="co">#&gt; (Intercept)    I(1/disp)           wt  </span></span>
<span id="cb34-92"><a href="#cb34-92"></a><span class="co">#&gt;      19.024     1142.560       -1.798</span></span></code></pre></div>
</div>
<div id="question-15" class="section level2">
<h2>Question</h2>
<p>Excecises 3 and 6 (page 213-214, Advanced R). Note: the anonymous function is defined in Section 10.2 (page 181, Advanced R)</p>
<ol start="3" style="list-style-type: decimal">
<li><p>The following code simulates the performance of a t-test for non-normal data. Use sapply() and an anonymous function to extract the p-value from every trial.</p>
<p>trials &lt;- replicate(100, t.test(rpois(10, 10), rpois(7, 10)), simplify = FALSE )</p></li>
</ol>
<p>Extra challenge: get rid of the anonymous function by using [[ directly.</p>
</div>
<div id="answer-15" class="section level2">
<h2>Answer</h2>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1"></a></span>
<span id="cb35-2"><a href="#cb35-2"></a> trials &lt;-<span class="st"> </span><span class="kw">replicate</span>(<span class="dv">100</span>,</span>
<span id="cb35-3"><a href="#cb35-3"></a>      <span class="kw">t.test</span>(<span class="kw">rpois</span>(<span class="dv">10</span>, <span class="dv">10</span>), <span class="kw">rpois</span>(<span class="dv">7</span>, <span class="dv">10</span>)),</span>
<span id="cb35-4"><a href="#cb35-4"></a>      <span class="dt">simplify =</span> <span class="ot">FALSE</span></span>
<span id="cb35-5"><a href="#cb35-5"></a>      )</span>
<span id="cb35-6"><a href="#cb35-6"></a><span class="co">#use sapply() and the anonymous function</span></span>
<span id="cb35-7"><a href="#cb35-7"></a><span class="kw">sapply</span>(trials,<span class="cf">function</span>(x){x<span class="op">$</span>p.value})</span>
<span id="cb35-8"><a href="#cb35-8"></a><span class="co">#&gt;   [1] 0.20271022 0.59736313 0.52750395 0.30679021 0.18897698 0.22102176</span></span>
<span id="cb35-9"><a href="#cb35-9"></a><span class="co">#&gt;   [7] 0.77751301 0.14029317 0.92620139 0.78776431 0.63335847 0.23043674</span></span>
<span id="cb35-10"><a href="#cb35-10"></a><span class="co">#&gt;  [13] 0.43987298 0.75463501 0.76232784 0.87554422 0.63416968 1.00000000</span></span>
<span id="cb35-11"><a href="#cb35-11"></a><span class="co">#&gt;  [19] 0.35078385 0.06401906 0.51070315 0.01276822 0.50565272 0.27574731</span></span>
<span id="cb35-12"><a href="#cb35-12"></a><span class="co">#&gt;  [25] 0.58279146 0.09715378 0.95739829 0.55182775 0.78589374 0.41951376</span></span>
<span id="cb35-13"><a href="#cb35-13"></a><span class="co">#&gt;  [31] 0.22909430 0.30609686 0.11255939 0.31872075 0.37880836 0.14716874</span></span>
<span id="cb35-14"><a href="#cb35-14"></a><span class="co">#&gt;  [37] 0.51293412 0.94622215 0.81639392 0.51575975 0.22011373 0.36105273</span></span>
<span id="cb35-15"><a href="#cb35-15"></a><span class="co">#&gt;  [43] 0.87832936 0.87412113 0.96783391 0.71314925 0.23228908 0.45344796</span></span>
<span id="cb35-16"><a href="#cb35-16"></a><span class="co">#&gt;  [49] 0.82134040 0.01305480 0.93443649 0.64645207 0.11281961 0.05699602</span></span>
<span id="cb35-17"><a href="#cb35-17"></a><span class="co">#&gt;  [55] 0.80652034 0.97173518 0.73743492 0.93516586 0.12318850 0.68160125</span></span>
<span id="cb35-18"><a href="#cb35-18"></a><span class="co">#&gt;  [61] 0.06581438 0.91149970 0.62679560 0.49106129 0.71743685 0.97410476</span></span>
<span id="cb35-19"><a href="#cb35-19"></a><span class="co">#&gt;  [67] 0.12253541 0.55707799 0.07558626 0.15701484 0.82876426 0.38954246</span></span>
<span id="cb35-20"><a href="#cb35-20"></a><span class="co">#&gt;  [73] 0.18452008 0.64012899 0.71490514 0.62322811 0.36772590 0.23187174</span></span>
<span id="cb35-21"><a href="#cb35-21"></a><span class="co">#&gt;  [79] 0.72695449 0.26349186 0.63832678 0.65340987 0.05176481 0.01829672</span></span>
<span id="cb35-22"><a href="#cb35-22"></a><span class="co">#&gt;  [85] 0.04468524 0.91013185 0.37482580 0.39568239 0.35865124 0.16036920</span></span>
<span id="cb35-23"><a href="#cb35-23"></a><span class="co">#&gt;  [91] 0.02801500 0.23861894 0.14986292 0.07366518 0.50299926 0.39410767</span></span>
<span id="cb35-24"><a href="#cb35-24"></a><span class="co">#&gt;  [97] 0.69624344 0.14782652 0.92842991 0.38297223</span></span>
<span id="cb35-25"><a href="#cb35-25"></a></span>
<span id="cb35-26"><a href="#cb35-26"></a><span class="co"># get rid of the anonymous function</span></span>
<span id="cb35-27"><a href="#cb35-27"></a><span class="kw">sapply</span>(trials,<span class="st">&quot;[[&quot;</span>,<span class="st">&quot;p.value&quot;</span>)</span>
<span id="cb35-28"><a href="#cb35-28"></a><span class="co">#&gt;   [1] 0.20271022 0.59736313 0.52750395 0.30679021 0.18897698 0.22102176</span></span>
<span id="cb35-29"><a href="#cb35-29"></a><span class="co">#&gt;   [7] 0.77751301 0.14029317 0.92620139 0.78776431 0.63335847 0.23043674</span></span>
<span id="cb35-30"><a href="#cb35-30"></a><span class="co">#&gt;  [13] 0.43987298 0.75463501 0.76232784 0.87554422 0.63416968 1.00000000</span></span>
<span id="cb35-31"><a href="#cb35-31"></a><span class="co">#&gt;  [19] 0.35078385 0.06401906 0.51070315 0.01276822 0.50565272 0.27574731</span></span>
<span id="cb35-32"><a href="#cb35-32"></a><span class="co">#&gt;  [25] 0.58279146 0.09715378 0.95739829 0.55182775 0.78589374 0.41951376</span></span>
<span id="cb35-33"><a href="#cb35-33"></a><span class="co">#&gt;  [31] 0.22909430 0.30609686 0.11255939 0.31872075 0.37880836 0.14716874</span></span>
<span id="cb35-34"><a href="#cb35-34"></a><span class="co">#&gt;  [37] 0.51293412 0.94622215 0.81639392 0.51575975 0.22011373 0.36105273</span></span>
<span id="cb35-35"><a href="#cb35-35"></a><span class="co">#&gt;  [43] 0.87832936 0.87412113 0.96783391 0.71314925 0.23228908 0.45344796</span></span>
<span id="cb35-36"><a href="#cb35-36"></a><span class="co">#&gt;  [49] 0.82134040 0.01305480 0.93443649 0.64645207 0.11281961 0.05699602</span></span>
<span id="cb35-37"><a href="#cb35-37"></a><span class="co">#&gt;  [55] 0.80652034 0.97173518 0.73743492 0.93516586 0.12318850 0.68160125</span></span>
<span id="cb35-38"><a href="#cb35-38"></a><span class="co">#&gt;  [61] 0.06581438 0.91149970 0.62679560 0.49106129 0.71743685 0.97410476</span></span>
<span id="cb35-39"><a href="#cb35-39"></a><span class="co">#&gt;  [67] 0.12253541 0.55707799 0.07558626 0.15701484 0.82876426 0.38954246</span></span>
<span id="cb35-40"><a href="#cb35-40"></a><span class="co">#&gt;  [73] 0.18452008 0.64012899 0.71490514 0.62322811 0.36772590 0.23187174</span></span>
<span id="cb35-41"><a href="#cb35-41"></a><span class="co">#&gt;  [79] 0.72695449 0.26349186 0.63832678 0.65340987 0.05176481 0.01829672</span></span>
<span id="cb35-42"><a href="#cb35-42"></a><span class="co">#&gt;  [85] 0.04468524 0.91013185 0.37482580 0.39568239 0.35865124 0.16036920</span></span>
<span id="cb35-43"><a href="#cb35-43"></a><span class="co">#&gt;  [91] 0.02801500 0.23861894 0.14986292 0.07366518 0.50299926 0.39410767</span></span>
<span id="cb35-44"><a href="#cb35-44"></a><span class="co">#&gt;  [97] 0.69624344 0.14782652 0.92842991 0.38297223</span></span></code></pre></div>
<ol start="6" style="list-style-type: decimal">
<li>Implement a combination of Map() and vapply() to create an lapply() variant that iterates in parallel over all of its inputs and stores its outputs in a vector (or a matrix). What arguments should the function take?</li>
</ol>
</div>
<div id="answer-16" class="section level2">
<h2>Answer</h2>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1"></a></span>
<span id="cb36-2"><a href="#cb36-2"></a>L &lt;-<span class="st"> </span><span class="kw">list</span>(mtcars,trees)</span>
<span id="cb36-3"><a href="#cb36-3"></a></span>
<span id="cb36-4"><a href="#cb36-4"></a><span class="kw">lapply</span>(L, <span class="cf">function</span>(x) <span class="kw">vapply</span>(x, mean, <span class="kw">numeric</span>(<span class="dv">1</span>)))</span>
<span id="cb36-5"><a href="#cb36-5"></a><span class="co">#&gt; [[1]]</span></span>
<span id="cb36-6"><a href="#cb36-6"></a><span class="co">#&gt;        mpg        cyl       disp         hp       drat         wt       qsec </span></span>
<span id="cb36-7"><a href="#cb36-7"></a><span class="co">#&gt;  20.090625   6.187500 230.721875 146.687500   3.596563   3.217250  17.848750 </span></span>
<span id="cb36-8"><a href="#cb36-8"></a><span class="co">#&gt;         vs         am       gear       carb </span></span>
<span id="cb36-9"><a href="#cb36-9"></a><span class="co">#&gt;   0.437500   0.406250   3.687500   2.812500 </span></span>
<span id="cb36-10"><a href="#cb36-10"></a><span class="co">#&gt; </span></span>
<span id="cb36-11"><a href="#cb36-11"></a><span class="co">#&gt; [[2]]</span></span>
<span id="cb36-12"><a href="#cb36-12"></a><span class="co">#&gt;    Girth   Height   Volume </span></span>
<span id="cb36-13"><a href="#cb36-13"></a><span class="co">#&gt; 13.24839 76.00000 30.17097</span></span>
<span id="cb36-14"><a href="#cb36-14"></a></span>
<span id="cb36-15"><a href="#cb36-15"></a>Mapply &lt;-<span class="st"> </span><span class="cf">function</span>(X, FUN, FUN.VALUE, <span class="dt">simplify =</span> <span class="ot">FALSE</span>){</span>
<span id="cb36-16"><a href="#cb36-16"></a>  out &lt;-<span class="st"> </span><span class="kw">Map</span>(<span class="cf">function</span>(x) <span class="kw">vapply</span>(x, FUN, FUN.VALUE), X)</span>
<span id="cb36-17"><a href="#cb36-17"></a>  <span class="cf">if</span>(simplify <span class="op">==</span><span class="st"> </span><span class="ot">TRUE</span>){<span class="kw">return</span>(<span class="kw">simplify2array</span>(out))}</span>
<span id="cb36-18"><a href="#cb36-18"></a>  out</span>
<span id="cb36-19"><a href="#cb36-19"></a>}</span>
<span id="cb36-20"><a href="#cb36-20"></a></span>
<span id="cb36-21"><a href="#cb36-21"></a><span class="kw">Mapply</span>(L, mean, <span class="kw">numeric</span>(<span class="dv">1</span>))</span>
<span id="cb36-22"><a href="#cb36-22"></a><span class="co">#&gt; [[1]]</span></span>
<span id="cb36-23"><a href="#cb36-23"></a><span class="co">#&gt;        mpg        cyl       disp         hp       drat         wt       qsec </span></span>
<span id="cb36-24"><a href="#cb36-24"></a><span class="co">#&gt;  20.090625   6.187500 230.721875 146.687500   3.596563   3.217250  17.848750 </span></span>
<span id="cb36-25"><a href="#cb36-25"></a><span class="co">#&gt;         vs         am       gear       carb </span></span>
<span id="cb36-26"><a href="#cb36-26"></a><span class="co">#&gt;   0.437500   0.406250   3.687500   2.812500 </span></span>
<span id="cb36-27"><a href="#cb36-27"></a><span class="co">#&gt; </span></span>
<span id="cb36-28"><a href="#cb36-28"></a><span class="co">#&gt; [[2]]</span></span>
<span id="cb36-29"><a href="#cb36-29"></a><span class="co">#&gt;    Girth   Height   Volume </span></span>
<span id="cb36-30"><a href="#cb36-30"></a><span class="co">#&gt; 13.24839 76.00000 30.17097</span></span></code></pre></div>
</div>
<div id="hw9" class="section level2">
<h2>HW9</h2>
</div>
<div id="question-16" class="section level2">
<h2>Question</h2>
<ol style="list-style-type: decimal">
<li>Write an Rcpp function for Exercise 9.4 (page 277, Statistical Computing with R).</li>
<li>Compare the corresponding generated random numbers with those by the R function you wrote before using the function “qqplot”.</li>
<li>Campare the computation time of the two functions with the function “microbenchmark”.</li>
<li>Comments your results.</li>
</ol>
</div>
<div id="answer-17" class="section level2">
<h2>Answer</h2>
<div id="exercise9.4" class="section level4">
<h4>Exercise9.4</h4>
<p>Implement a random walk Metropolis sampler for generating the standard Laplace distribution (see Exercise 3.2). For the increment, simulate from a normal distribution. Compare the chains generated when different variances are used for the proposal distribution. Also, compute the acceptance rates of each chain.</p>
</div>
<div id="r-function" class="section level4">
<h4>R function</h4>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1"></a>rwr &lt;-<span class="st"> </span><span class="cf">function</span>(sigma, x0, N){</span>
<span id="cb37-2"><a href="#cb37-2"></a> x =<span class="st"> </span><span class="kw">numeric</span>(N)</span>
<span id="cb37-3"><a href="#cb37-3"></a> x[<span class="dv">1</span>] =<span class="st"> </span>x0</span>
<span id="cb37-4"><a href="#cb37-4"></a> u =<span class="st"> </span><span class="kw">runif</span>(N)</span>
<span id="cb37-5"><a href="#cb37-5"></a> k =<span class="st"> </span><span class="dv">0</span></span>
<span id="cb37-6"><a href="#cb37-6"></a> <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="op">:</span>N) {</span>
<span id="cb37-7"><a href="#cb37-7"></a>  y =<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">1</span>, x[i<span class="dv">-1</span>], sigma)</span>
<span id="cb37-8"><a href="#cb37-8"></a>  <span class="cf">if</span> (u[i] <span class="op">&lt;=</span><span class="st"> </span><span class="kw">exp</span>(<span class="kw">abs</span>(x[i<span class="dv">-1</span>])<span class="op">-</span><span class="kw">abs</span>(y))) x[i] =<span class="st"> </span>y </span>
<span id="cb37-9"><a href="#cb37-9"></a>  <span class="cf">else</span> {</span>
<span id="cb37-10"><a href="#cb37-10"></a>  x[i] =<span class="st"> </span>x[i<span class="dv">-1</span>]</span>
<span id="cb37-11"><a href="#cb37-11"></a>  k =<span class="st"> </span>k<span class="op">+</span><span class="dv">1</span></span>
<span id="cb37-12"><a href="#cb37-12"></a>  }</span>
<span id="cb37-13"><a href="#cb37-13"></a> }</span>
<span id="cb37-14"><a href="#cb37-14"></a> <span class="kw">return</span>(<span class="kw">list</span>(<span class="dt">x =</span> x, <span class="dt">k =</span> k))</span>
<span id="cb37-15"><a href="#cb37-15"></a>}</span></code></pre></div>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
